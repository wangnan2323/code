var t_code_menu_detail_Obj=function(){"use strict";function p(t,i){var u="<blockquote> ";u+='<h3>将对被选中的数据进行<a style="color:red">删除<\/a><\/h3>';u+="<\/blockquote> ";_confirmMessage.destory();_confirmMessage.show("删除确认？",u,{confirm:function(){r.start();doAjaxFunction(n,"DeleteMenuById",{nodeid:t,clientInf:_clientInf},{success:function(n){r.stop();n?_alertMessage.show(n,"warning",5e3):(_alertMessage.show("删除成功！","success",2e3),i.success())},fail:function(n){r.stop();_alertMessage.show(n,"fail")}})},cancle:function(){_alertMessage.show("操作已取消","success",1e3)}})}function w(){var n=controlObj.text("detail_txt_nodeid_t_code_menu_detail"),t=controlObj.text("detail_txt_nodename_t_code_menu_detail");s(n,t)}function s(i,r,u){doAjaxFunction(n,"CreateByParentNode",{parentnodeid:i||"",parentnodename:r||"",appname:t_codeObj.getAppname(),clientInf:_clientInf},{success:function(n){t_codeObj.load_tree(n);t._pr_nodeid=n;u&&u.success&&u.success();o({success:function(t){e(t,{success:function(){t_code_content_modallist_Obj.menuid=n;t_code_content_modallist_Obj.bindGrid({success:function(){}})}})}})},fail:function(n){_alertMessage.show(n,"fail")}})}function b(){var n=controlObj.text("detail_txt_parentnodeid_t_code_menu_detail"),t=controlObj.text("detail_txt_parentnodename_t_code_menu_detail");n?s(n,t):_alertMessage.show("当前选中节点不允许创建同级，请重新选择后再试！","warning",5e3)}var n="//127.0.0.1/sara.dd.ldsw/sara.platform.operation/code/service/service_t_code_menu.asmx/",u=null,i=null,r=null,h=function(n){n.success();return},c=function(n){try{controlObj.singledropdownlistinit("detail_txt_nodetype_t_code_menu_detail",t_codeObj.getSfData());controlObj.singledropdownlistinit("detail_txt_nodeclass_t_code_menu_detail",t_codeObj.getSfData());n.success()}catch(t){_blockMessage.show("initControl执行失败。<br/>"+t.message,"fail")}},f=function(n){try{controlObj.textdisable("detail_txt_id_t_code_menu_detail",!0);controlObj.textdisable("detail_txt_nodeid_t_code_menu_detail",!0);controlObj.textdisable("detail_txt_nodename_t_code_menu_detail",n);controlObj.textdisable("detail_txt_parentnodeid_t_code_menu_detail",!0);controlObj.textdisable("detail_txt_parentnodename_t_code_menu_detail",!0);controlObj.singledropdownlistdisable("detail_txt_nodeclass_t_code_menu_detail",n);controlObj.textdisable("detail_txt_nodelayer_t_code_menu_detail",!1);controlObj.singledropdownlistdisable("detail_txt_nodetype_t_code_menu_detail",n);controlObj.textdisable("detail_txt_nodetable_t_code_menu_detail",n);controlObj.textdisable("detail_txt_nodeoperpage_t_code_menu_detail",n);controlObj.textdisable("detail_txt_appname_t_code_menu_detail",!0);n?($("#btn_command_save_t_code_menu_detail").addClass("hidden"),$(".btn-command-message").attr("disabled","disabled")):($("#btn_command_save_t_code_menu_detail").removeClass("hidden"),$(".btn-command-message").removeAttr("disabled"))}catch(t){_blockMessage.show("setDisable执行失败。<br/>"+t.message,"fail")}},e=function(n,t){controlObj.text("detail_txt_id_t_code_menu_detail",n.id);controlObj.text("detail_txt_nodeid_t_code_menu_detail",n.nodeid);controlObj.text("detail_txt_nodename_t_code_menu_detail",n.nodename);controlObj.text("detail_txt_parentnodeid_t_code_menu_detail",n.parentnodeid);controlObj.text("detail_txt_parentnodename_t_code_menu_detail",n.parentnodename);controlObj.singledropdownlistid("detail_txt_nodeclass_t_code_menu_detail",n.nodeclass);controlObj.text("detail_txt_nodelayer_t_code_menu_detail",n.nodelayer);controlObj.singledropdownlistid("detail_txt_nodetype_t_code_menu_detail",n.nodetype);controlObj.text("detail_txt_nodetable_t_code_menu_detail",n.nodetable);controlObj.text("detail_txt_nodeoperpage_t_code_menu_detail",n.nodeoperpage);controlObj.text("detail_txt_appname_t_code_menu_detail",n.appname);t.success()},l=function(){controlObj.text("detail_txt_id_t_code_menu_detail","");controlObj.text("detail_txt_nodeid_t_code_menu_detail","");controlObj.text("detail_txt_nodename_t_code_menu_detail","");controlObj.text("detail_txt_parentnodeid_t_code_menu_detail","");controlObj.text("detail_txt_parentnodename_t_code_menu_detail","");controlObj.singledropdownlistid("detail_txt_nodeclass_t_code_menu_detail","");controlObj.text("detail_txt_nodelayer_t_code_menu_detail","");controlObj.singledropdownlistid("detail_txt_nodetype_t_code_menu_detail","");controlObj.text("detail_txt_nodetable_t_code_menu_detail","");controlObj.text("detail_txt_nodeoperpage_t_code_menu_detail","");controlObj.text("detail_txt_appname_t_code_menu_detail","")},a=function(n){try{var t={};t.id=controlObj.text("detail_txt_id_t_code_menu_detail");t.nodeid=controlObj.text("detail_txt_nodeid_t_code_menu_detail");t.nodename=controlObj.text("detail_txt_nodename_t_code_menu_detail");t.parentnodeid=controlObj.text("detail_txt_parentnodeid_t_code_menu_detail");t.parentnodename=controlObj.text("detail_txt_parentnodename_t_code_menu_detail");t.nodeclass=controlObj.singledropdownlistid("detail_txt_nodeclass_t_code_menu_detail");t.nodelayer=controlObj.text("detail_txt_nodelayer_t_code_menu_detail");t.nodetype=controlObj.singledropdownlistid("detail_txt_nodetype_t_code_menu_detail");t.nodetable=controlObj.text("detail_txt_nodetable_t_code_menu_detail");t.nodeoperpage=controlObj.text("detail_txt_nodeoperpage_t_code_menu_detail");t.appname=controlObj.text("detail_txt_appname_t_code_menu_detail");n.success(t)}catch(i){_blockMessage.show("getData执行失败。<br/>"+i.message,"fail")}},v=function(n,t){try{var i=new hashMap,r=new hashMap;n.id.length>100&&(i.put("detail_txt_id_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_id_t_code_menu_detail","top"));n.nodeid.length>100&&(i.put("detail_txt_nodeid_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_nodeid_t_code_menu_detail","top"));n.nodename.length>100&&(i.put("detail_txt_nodename_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_nodename_t_code_menu_detail","top"));n.parentnodeid.length>100&&(i.put("detail_txt_parentnodeid_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_parentnodeid_t_code_menu_detail","top"));n.parentnodename.length>100&&(i.put("detail_txt_parentnodename_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_parentnodename_t_code_menu_detail","top"));n.nodeclass.length>100&&(i.put("detail_txt_nodeclass_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_nodeclass_t_code_menu_detail","top"));n.nodelayer.length>100&&(i.put("detail_txt_nodelayer_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_nodelayer_t_code_menu_detail","top"));n.nodetype.length>100&&(i.put("detail_txt_nodetype_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_nodetype_t_code_menu_detail","top"));n.nodetable.length>100&&(i.put("detail_txt_nodetable_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_nodetable_t_code_menu_detail","top"));n.nodeoperpage.length>100&&(i.put("detail_txt_nodeoperpage_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_nodeoperpage_t_code_menu_detail","top"));n.appname.length>100&&(i.put("detail_txt_appname_t_code_menu_detail",'长度不能超过<a style="color:red">100<\/a>'),r.put("detail_txt_appname_t_code_menu_detail","top"));i.keys().length>0?(u.show(i,r,!0),t.fail()):(u.hidden(),t.success(n))}catch(f){_blockMessage.show("checkData执行失败。<br/>"+f.message,"fail")}},o=function(i){var r=" nodeid = '"+t._pr_nodeid+"'",u={whereString:r,orderByString:"",columnsString:"id^nodeid^nodename^parentnodeid^parentnodename^nodeclass^nodelayer^nodetype^nodetable^nodeoperpage^appname",pageSizeString:"",pageIndexString:"",clientInf:_clientInf};doAjaxFunction(n,"GetList",u,{success:function(n){var t=new Function("","return "+n)();i.success(t.rows[0])},fail:function(t){_blockMessage.show(n+"GetList<br/>"+t,"fail")}})},y=function(t,i){var f=new Date,r={id:t.id,nodeid:t.nodeid,nodename:t.nodename,parentnodeid:t.parentnodeid,parentnodename:t.parentnodename,nodeclass:t.nodeclass,nodelayer:t.nodelayer,nodetype:t.nodetype,nodetable:t.nodetable,nodeoperpage:t.nodeoperpage,appname:t.appname},u={columns:"id^nodeid^nodename^parentnodeid^parentnodename^nodeclass^nodelayer^nodetype^nodetable^nodeoperpage^appname",clientInf:_clientInf,json:JSON.stringify(r)};doAjaxFunction(n,"Update",u,{success:function(){i.success()},fail:function(n){i.fail(n)},error:function(t){_blockMessage.show(n+"Update<br/>"+t,"fail")}})},t={_pr_nodeid:"",_pr_pagetype:"",init:function(n){try{h({success:function(){c({success:function(){u=new validateMessage("btn_command_save_t_code_menu_detail");i=Ladda.create("btn_command_save_t_code_menu_detail");r=Ladda.create("btn_command_cancle_t_code_menu_detail");switch(t._pr_pagetype){case"1":f(!1);break;case"2":f(!0)}n.success()}})}})}catch(e){_blockMessage.show("程序初始化失败。<br/>"+e.message,"fail")}},bindPage:function(n){try{t._pr_nodeid?o({success:function(t){e(t,{success:function(){n.success()}})}}):l()}catch(i){_blockMessage.show("bindPage执行失败。<br/>"+i.message,"fail")}},btn_command_save_onclick:function(){try{if(!t._pr_nodeid){_alertMessage.show("当前并没有选中节点，无法保存","warning");return}i.start();a({success:function(n){v(n,{success:function(n){y(n,{success:function(){i.stop();_alertMessage.show("保存成功","success",2e3);t_codeObj.load_tree(n.nodeid)},fail:function(n){i.stop();_alertMessage.show("保存失败<br/>"+n,"fail")}})},fail:function(){i.stop();_alertMessage.show("校验未通过","warning")}})}})}catch(n){_blockMessage.show("保存程序异常。","fail")}},btn_command_delete_onclick:function(){var t=t_codeObj.getcurrentselectednode(),n=t.attr("nodeid");if(n){if(t.next("ul").find("li").length>0){_alertMessage.show("当前节点有子节点，请先删除子节点！","warning",5e3);return}p(n,{success:function(){var t=n.substr(0,n.length-4);t_codeObj.reload_all(t)}})}else{_alertMessage.show("当前选中节点不能删除！","warning",5e3);return}},btn_command_new_onclick:w,btn_command_new2_onclick:b};return t}();
