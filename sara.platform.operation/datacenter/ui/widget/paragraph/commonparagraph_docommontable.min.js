function doCommonTable(n,t,i,r,u,f){this.bind=function(e){var o=t[i],a="#div_"+n.paragraphid,w,v,c,l,h,y,s,p;a+=">#div_row";a+=">#"+o.targetdiv;w='<div id="div_search" data-ss="ss" class="hidden">    <div id="div_query" class="input-group col-md-12 col-xs-12">                                                                                                   <input id="txt_query" type="text" class="form-control">                                                                                                    <span id="span_query" class="input-group-btn">                                                                                                                 <button id="btn_query" class="btn btn-primary" data-loading-text="正在加载..." type="button">查询<\/button>                                             <\/span>                                                                                                                                                <\/div>                                                                                                                                                 <\/div>                                                                                                                                                     <div id="div_table" class="row">                                                                                                                           <\/div>                                                                                                                                                     <div id="div_pager" class="hidden">                                                                                                                                                                                                                                                                                       <ul id="ul_pager" class="pager">                                                                                                                               <li id="li_pre" class="previous"><a id="btn_pre" data-loading-text="正在加载...">前一页<\/a><\/li>                                                           <li id="li_current" class="disabled pagination-sm">第<a id="a_pageIndex" class="disabled"><\/a>页/共<a id="a_pageCount" class="disabled"><\/a>页<\/li>        <li id="li_next" class="next"><a id="btn_next" data-loading-text="正在加载...">后一页<\/a><\/li>                                                         <\/ul>                                                                                                                                                  <\/div>                                                                                                                                                     ';$(a).html(w);v=a;v+=">#div_search";v+=">#div_query";c=typeof o.column;switch(c){case"string":case"undefined":o.column=[]}c=typeof o.ispager;switch(c){case"object":case"undefined":o.ispager=""}c=typeof o.pagesize;switch(c){case"object":case"undefined":o.pagesize=""}c=typeof o.issearch;switch(c){case"object":case"undefined":o.issearch=""}o.ispager=="true"?$(a+">#div_pager").attr("class","row"):$(a+">#div_pager").attr("class","hidden");o.issearch=="true"?($(a+">#div_search").attr("class","row"),$(v+">#span_query>#btn_query").unbind("click"),$(v+">#span_query>#btn_query").bind("click",function(){$(v+">#span_query>#btn_query").unbind("click");$(v+">#span_query>#btn_query").attr("disabled","disabled");var f=new doCommonTable(n,t,i,r,u,"1");f.bind({successHandler:function(){}});f=null})):$(a+">#div_search").attr("class","hidden");l=o.datawhere;l=initWhereStringByQueryParameterHashMap(r,l,n.paragraphid,o.targetdiv);h=$(v+">#txt_query").val().split(" ");h.removevalue("");y=o.datacolumn.split("^");l==""&&(l=" 1=1 ");$.each(h,function(n){h[n]!=""&&(l+=" and (",$.each(y,function(t){y[t]!=""&&(l+=y[t]+" like ‘％"+h[n]+"％’",y.length-1!=t&&(l+=" or "))}),l+=")")});s="";p=JSON.stringify({dataNameString:o.dataname,whereString:l,columnsString:o.datacolumn,orderByString:o.dataorderby,pageSizeString:o.ispager=="true"?o.pagesize||u:"",pageIndexString:f});doAjaxFunction(_commonserviceurl+"GetCommonData",p,{success:function(y){var g=new Function("","return "+y)(),ft=parseInt(g.total),w,ut,rt;g=g.rows;s+='<div id="div_table_responsive" class="table-responsive">';s+='<table class="table table-bordered  table-hover table-condensed">';s+="<thead><tr>";$.each(o.column,function(n){o.column[n].visable=="true"&&(s+="<th>"+o.column[n].name+"<\/th>")});s+="<\/tr><\/thead>";s+="<tbody>";var b=[],tt=new hashMap,nt=[],it=new hashMap,k=null,d="";$.each(g,function(t){s+='<tr id="tr_'+n.paragraphid+"_"+o.targetdiv.replaceAll("_","-")+"_"+t+'">';$.each(o.column,function(i){var r,u,f;if(o.column[i].visable=="true"){r="";switch(o.column[i].type){case"string":r=g[t][o.column[i].data].toString().returnString();h.length==0||h.length==1&&h[0]==""||$.each(h,function(n){h[n]!=""&&r.indexOf(h[n])>-1&&(r=r.replaceAll(h[n],"<a style='background-color:yellow'>"+h[n]+"<\/a>"))});break;case"image":r=g[t][o.column[i].data].toString();r='<img src="'+_datacenterimageurl+r+'" width="16px" height="16px"/>';break;case"event":u=o.column[i].data.split("^")[0];f=g[t][o.column[i].data.split("^")[1]].toString();c=typeof o.column[i].event;switch(c){case"string":case"undefined":o.column[i].event=[]}d="a_"+n.paragraphid+"_"+o.targetdiv.replaceAll("_","-")+"_"+t+"_"+i;r='<a id="'+d+'" style="cursor:pointer">'+u+"<a>";k=new hashMap;k.put("columnname",u);k.put("rowname","");k.put("cellvalue",f);k.put("rowindex",t);k.put("columnindex",i);o.column[i].event.length>0?(b.push(d),tt.put(d+"_hasmap",k),tt.put(d+"_event",o.column[i].event)):(nt.push(d),it.put(d+"_modalhashmap",k),it.put(d+"_paragraphid",o.column[i].eventparagraphid))}s+="<td>"+r+"<\/td>"}});s+="<\/tr>"});s+="<\/tbody>";s+="<\/table>";s+="<\/div>";$("#div_"+n.paragraphid+">#div_row>#"+o.targetdiv+">#div_table").html(s);b.length>0&&($.each(b,function(t){$("#"+b[t]).unbind("click");$("#"+b[t]).bind("click",function(){var i=b[t].split("_"),r=$("#div_"+i[1]+">#div_row>#"+i[2].replaceAll("-","_")+">#div_table tbody tr");r.length>0&&$.each(r,function(n){r[n].className=="success"&&(r[n].className="")});$("#tr_"+i[1]+"_"+i[2]+"_"+i[3]).attr("class","success");i=null;doType(n,tt.get(b[t]+"_event"),0,tt.get(b[t]+"_hasmap"),{success:function(){}})})}),$("#tr_"+n.paragraphid+"_"+o.targetdiv.replaceAll("_","-")+"_0").attr("class","success"),doType(n,tt.get(b[0]+"_event"),0,tt.get(b[0]+"_hasmap"),{success:function(){}}));nt.length>0&&$.each(nt,function(n){$("#"+nt[n]).unbind("click");$("#"+nt[n]).bind("click",function(){doPaperModal(it.get(nt[n]+"_modalhashmap"),it.get(nt[n]+"_paragraphid"))})});o.ispager=="true"&&(w=a+">#div_pager>#ul_pager",ut=0,ut=o.pagesize==""?parseInt(u):parseInt(o.pagesize),f=parseInt(f),rt=Math.ceil(ft/ut),$(w+">#li_current>#a_pageIndex").html(f),$(w+">#li_current>#a_pageCount").html(rt),f!=1?($(w+">#li_pre>#btn_pre").attr("class",""),$(w+">#li_pre").attr("class",""),$(w+">#li_pre>#btn_pre").unbind("click"),$(w+">#li_pre>#btn_pre").bind("click",function(){$(w+">#li_pre>#btn_pre").unbind("click");$(w+">#li_pre>#btn_pre").attr("disabled","disabled");var e=new doCommonTable(n,t,i,r,u,f-1);e.bind({successHandler:function(){}});e=null})):($(w+">#li_pre>#btn_pre").attr("class","disabled"),$(w+">#li_pre").attr("class","disabled")),f<rt?($(w+">#li_next>#btn_next").attr("class",""),$(w+">#li_next").attr("class",""),$(w+">#li_next>#btn_next").unbind("click"),$(w+">#li_next>#btn_next").bind("click",function(){$(w+">#li_next>#btn_next").unbind("click");$(w+">#li_next>#btn_next").attr("disabled","disabled");var e=new doCommonTable(n,t,i,r,u,f+1);e.bind({successHandler:function(){}});e=null})):($(w+">#li_next>#btn_next").attr("class","disabled"),$(w+">#li_next").attr("class","disabled")),w=null);d=null;k=null;v=null;c=null;h=null;l=null;p=null;s=null;ajaxResultJson=null;g=null;ft=null;w=null;rt=null;o=null;GC();e.successHandler(n,t,i,r)},fail:function(n){alert(n)}})}}
