var t_datacenter_paragraph_list_Obj=function(){"use strict";var u="//127.0.0.1/sara.dd.ldsw/sara.platform.operation/datacenter/service/service_t_datacenter_paragraph.asmx/",t="",h=null,f=null,i=null,o="",c=function(t){try{n._pr_gridpageindex=n._pr_gridpageindex==null||n._pr_gridpageindex==""||n._pr_gridpageindex=="null"?1:Number(n._pr_gridpageindex);n._pr_searchcontent=n._pr_searchcontent==null||n._pr_searchcontent==""||n._pr_searchcontent=="null"?{}:new Function("","return "+n._pr_searchcontent)();(n._pr_searchtype==null||n._pr_searchtype==""||n._pr_searchtype=="null")&&(n._pr_searchtype="1");switch(n._pr_searchtype){case"1":$("#btn_command_search_t_datacenter_paragraph_list").html("简单查询");$("#txt_command_search_t_datacenter_paragraph_list").removeAttr("disabled");break;case"2":$("#btn_command_search_t_datacenter_paragraph_list").html("高级查询");$("#txt_command_search_t_datacenter_paragraph_list").attr("disabled",!0)}n._pr_listtype==null||n._pr_listtype==""||n._pr_listtype=="null"?_blockMessage.show("listtype参数接收失败...","fail"):t.success()}catch(i){_blockMessage.show("initParameter执行失败"+i.message,"fail")}},l=function(i){try{$("#table_grid_t_datacenter_paragraph_list").bootstrapTable({cache:!1,height:800,striped:!0,pagination:!0,pageSize:t,pageList:[t],pageNumber:n._pr_gridpageindex,search:!1,showColumns:!1,showRefresh:!1,clickToSelect:!0,idField:"sys_id",sidePagination:"webserver",columns:[{field:"_checkbox",checkbox:!0,formatter:function(t,i){switch(n._pr_listtype){case"1":return("^"+n._pr_gridselectids+"^").indexOf("^"+i.sys_id+"^")>-1?{disabled:!1,checked:!0}:t;case"2":return("^"+n._pr_gridselectids+"^").indexOf("^"+i.sys_id+"^")>-1?{disabled:!0,checked:!0}:{disabled:!0}}}},{field:"sys_id",title:"sys_id",align:"center",valign:"middle",visible:!1,sortable:!0},{field:"paragraphid",title:"段落id","class":"",align:"left",valign:"middle",sortable:!0,clickToSelect:!0,formatter:function(n,t){var i=t.paragraphnodeid.length*5;return'<div style="margin-left:'+i+'px">'+t.paragraphnodeid+"<br/>"+n+"<br/>"+t.paragraphtitle+"<\/div>"}},{field:"",title:"操作",align:"center",valign:"middle",sortable:!1,clickToSelect:!1,formatter:function(){switch(n._pr_listtype){case"1":return'<a class="edit ml10" href="javascript:void(0)" title="编辑"><i class="glyphicon glyphicon-edit"><\/i><\/a>';case"2":return'<a class="view ml10" href="javascript:void(0)" title="浏览"><i class="glyphicon glyphicon-eye-open"><\/i><\/a>'}},events:{"click .view":function(n,t,i){e(i.sys_id,"2")},"click .edit":function(n,t,i){e(i.sys_id,"1")}}}],onPageChange:function(t,i){n._pr_gridpageindex=i;n.bindGrid()},rowStyle:function(){return{}},onLoadSuccess:function(){},onCheck:function(t){n._pr_gridselectids+="^"+t.sys_id;n._pr_gridselectids=n._pr_gridselectids.trimStartEnd("^");r()},onUncheck:function(t){n._pr_gridselectids=("^"+n._pr_gridselectids+"^").replaceAll("^"+t.sys_id+"^","^");n._pr_gridselectids=n._pr_gridselectids.trimStartEnd("^");r()},onCheckAll:function(){var t=$("#table_grid_t_datacenter_paragraph_list").bootstrapTable("getSelections");$.each(t,function(i){("^"+n._pr_gridselectids+"^").indexOf("^"+t[i].sys_id+"^")>-1||(n._pr_gridselectids+="^"+t[i].sys_id)});n._pr_gridselectids=n._pr_gridselectids.trimStartEnd("^");r()},onUncheckAll:function(){var t=$("#table_grid_t_datacenter_paragraph_list").bootstrapTable("getData");$.each(t,function(i){("^"+n._pr_gridselectids+"^").indexOf("^"+t[i].sys_id+"^")>-1&&(n._pr_gridselectids=("^"+n._pr_gridselectids+"^").replaceAll("^"+t[i].sys_id+"^","^"))});n._pr_gridselectids=n._pr_gridselectids.trimStartEnd("^");r()}});i.success()}catch(u){_blockMessage.show("initGrid执行失败<br/>"+u.message,"fail")}},s=function(n){n?($("#btn_command_new_t_datacenter_paragraph_list").addClass("hidden"),$("#btn_command_delete_t_datacenter_paragraph_list").addClass("hidden")):($("#btn_command_new_t_datacenter_paragraph_list").removeClass("hidden"),$("#btn_command_delete_t_datacenter_paragraph_list").removeClass("hidden"))},e=function(t){$("#table_grid_t_datacenter_paragraph_list").find("tr.success").removeClass("success");$("#tr_"+t).addClass("success");$("#div_content_part_t_datacenter_paragraph_detail").load("../t_datacenter_paragraph/t_datacenter_paragraph_detail_part.html",null,function(){t_datacenter_paragraph_detail_Obj._pr_pagetype=n._pr_listtype;t_datacenter_paragraph_detail_Obj.init({success:function(){t_datacenter_paragraph_detail_Obj._pr_sys_id=t;t_datacenter_paragraph_detail_Obj.bindPage({success:function(){}})}})})},r=function(){if(n._pr_gridselectids=="")$("#btn_command_clearselect_t_datacenter_paragraph_list").addClass("hidden");else{$("#btn_command_clearselect_t_datacenter_paragraph_list").removeClass("hidden");var t=n._pr_gridselectids.split("^").length,i=$("#table_grid_t_datacenter_paragraph_list").bootstrapTable("getSelections").length;$("#btn_command_clearselect_t_datacenter_paragraph_list .cc-badge-p").html(i+"/"+t)}},n={_pr_listtype:"",_pr_gridselectids:"",_pr_gridpageindex:1,_pr_searchtype:"1",_pr_searchcontent:null,_pr_paper_id:"",_pr_list_count:"",_pr_index0:"",init:function(t){try{c({success:function(){l({success:function(){n.bindGrid({success:function(){h=new validateMessage("btn_search_modal_search_t_datacenter_paragraph_list");f=Ladda.create("btn_command_new_t_datacenter_paragraph_list");i=Ladda.create("btn_command_delete_t_datacenter_paragraph_list");switch(n._pr_listtype){case"1":s(!1);break;case"2":s(!0)}n._pr_index0!=""&&e(n._pr_index0,n._pr_listtype);t.success()}})}})}})}catch(r){_blockMessage.show("程序初始化失败。<br/>"+r.message,"fail")}},bindGrid:function(i){setTimeout(function(){var f=o;f!=""&&(f+=" and ");f+="paperid='"+n._pr_paper_id+"'";var e={whereString:f,orderByString:" paragraphnodeid asc",columnsString:"f_value1^f_value2^f_value3^f_value4^f_value5^f_value6^f_value7^f_value8^f_value9^f_value10^paragraphid^paragraphnodeid^paragraphtitle^paragraphresume^paragraphlayout^paragraphcode^paragraphcontent^paperid^paragraphcodeid^sys_id",pageSizeString:t,pageIndexString:n._pr_gridpageindex,clientInf:_clientInf};doAjaxFunction(u,"GetList",e,{success:function(t){var u=new Function("","return "+t)();n._pr_list_count=u.total;$("#table_grid_t_datacenter_paragraph_list").bootstrapTable("loadJson",u);u.rows.length>0&&(n._pr_index0=u.rows[0].sys_id);r();i!=undefined&&i!=null&&i.success()},fail:function(n){_blockMessage.show("bindGrid执行失败<br/>"+n,"fail")}})},0)},btn_command_new_onclick:function(){f.start();var t=new Date,i={f_file:controlObj.fileuploadernewfileid(),paragraphtitle:"新建标题",paragraphcode:"commonparagraph",paragraphcontent:"【{}】",paperid:n._pr_paper_id,sys_delflag:"0",sys_lasteditusername:basePageObj._userInfoJson.sys_username,sys_lastedituserid:basePageObj._userInfoJson.sys_userid,sys_lasteditdate:t.Format("yyyy-MM-dd hh:mm:ss"),sys_creatdate:t.Format("yyyy-MM-dd hh:mm:ss"),sys_creatusername:basePageObj._userInfoJson.sys_username,sys_creatuserid:basePageObj._userInfoJson.sys_userid},r={json:JSON.stringify(i),clientInf:_clientInf};doAjaxFunction(u,"Add",r,{success:function(t){f.stop();n.bindGrid({success:function(){e(t,"1")}})},fail:function(n){_alertMessage.show("新建数据执行失败<br/>"+n,"fail");f.stop()}})},btn_command_delete_onclick:function(){var f=n._pr_gridselectids.split("^").length;if(n._pr_gridselectids=="")_alertMessage.show("至少选择一条数据!","warning",1e3);else{var e=$("#table_grid_t_datacenter_paragraph_list").bootstrapTable("getSelections").length,s=f-e,r="<blockquote> ";r+='<h3>将对被选中的全部数据<a style="color:red">'+f+'<\/a>条进行<a style="color:red">删除<\/a><\/h3>';r+="其中<br/>";r+='<h5><a style="color:red">当前页<\/a>的数据<a style="color:red">'+e+"<\/a>条<\/h5>";r+='<h5><a style="color:red">其他页<\/a>的数据<a style="color:red">'+s+"<\/a>条<\/h5>";r+="<\/blockquote> ";_confirmMessage.destory();_confirmMessage.show("删除确认？",r,{confirm:function(){i.start();var r="sys_id in ('"+n._pr_gridselectids.toString().replaceAll("^","','")+"')",f={clientInf:_clientInf,whereString:r};doAjaxFunction(u,"Delete",f,{success:function(){var r={clientInf:_clientInf,whereString:o};doAjaxFunction(u,"GetCount",r,{success:function(r){var u=parseInt(r);u<n._pr_gridpageindex*t&&(n._pr_gridpageindex=Math.ceil(u/t));n._pr_gridpageindex==0&&(n._pr_gridpageindex=1);n._pr_gridselectids="";n.bindGrid({success:function(){i.stop()}})},fail:function(n){_alertMessage.show("数据删除完成，获取数据条数失败<br/>"+n,"fail");i.stop()}})},fail:function(n){_alertMessage.show("数据删除失败<br/>"+n,"fail");i.stop()}})},cancle:function(){_alertMessage.show("操作已取消","success",1e3)}})}}};return n}();
