(function(n){function i(n){var r="    ",t,i;for(r=isNaN(parseInt(n))?n:new Array(n+1).join(" "),t=["\n"],i=0;i<100;i++)t.push(t[i]+r);return t}function r(n,t){return t-(n.replace(/\(/g,"").length-n.replace(/\)/g,"").length)}function u(n,t){return n.replace(/\s{1,}/g," ").replace(/ AND /ig,"~::~"+t+t+"AND ").replace(/ BETWEEN /ig,"~::~"+t+"BETWEEN ").replace(/ CASE /ig,"~::~"+t+"CASE ").replace(/ ELSE /ig,"~::~"+t+"ELSE ").replace(/ END /ig,"~::~"+t+"END ").replace(/ FROM /ig,"~::~FROM ").replace(/ GROUP\s{1,}BY/ig,"~::~GROUP BY ").replace(/ HAVING /ig,"~::~HAVING ").replace(/ IN /ig," IN ").replace(/ JOIN /ig,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /ig,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /ig,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /ig,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /ig,"~::~RIGHT JOIN ").replace(/ ON /ig,"~::~"+t+"ON ").replace(/ OR /ig,"~::~"+t+t+"OR ").replace(/ ORDER\s{1,}BY/ig,"~::~ORDER BY ").replace(/ OVER /ig,"~::~"+t+"OVER ").replace(/\(\s{0,}SELECT /ig,"~::~(SELECT ").replace(/\)\s{0,}SELECT /ig,")~::~SELECT ").replace(/ THEN /ig," THEN~::~"+t+"").replace(/ UNION /ig,"~::~UNION~::~").replace(/ USING /ig,"~::~USING ").replace(/ WHEN /ig,"~::~"+t+"WHEN ").replace(/ WHERE /ig,"~::~WHERE ").replace(/ WITH /ig,"~::~WITH ").replace(/ ALL /ig," ALL ").replace(/ AS /ig," AS ").replace(/ ASC /ig," ASC ").replace(/ DESC /ig," DESC ").replace(/ DISTINCT /ig," DISTINCT ").replace(/ EXISTS /ig," EXISTS ").replace(/ NOT /ig," NOT ").replace(/ NULL /ig," NULL ").replace(/ LIKE /ig," LIKE ").replace(/\s{0,}SELECT /ig,"SELECT ").replace(/\s{0,}UPDATE /ig,"UPDATE ").replace(/ SET /ig," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}var t=function(t){this.init(t);var i=this.options.method;n.isFunction(this[i])||n.error("'"+i+"' is not a Formatter method.");this.format=function(n){return this[this.options.method].call(this,n)}};t.prototype={options:{},init:function(t){this.options=n.extend({},n.fn.format.defaults,t);this.step=this.options.step;this.preserveComments=this.options.preserveComments;this.shift=i(this.step)},xml:function(n){for(var i=n.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),e=i.length,u=!1,f=0,r="",t=0,t=0;t<e;t++)i[t].search(/<!/)>-1?(r+=this.shift[f]+i[t],u=!0,(i[t].search(/-->/)>-1||i[t].search(/\]>/)>-1||i[t].search(/!DOCTYPE/)>-1)&&(u=!1)):i[t].search(/-->/)>-1||i[t].search(/\]>/)>-1?(r+=i[t],u=!1):/^<\w/.exec(i[t-1])&&/^<\/\w/.exec(i[t])&&/^<[\w:\-\.\,]+/.exec(i[t-1])==/^<\/[\w:\-\.\,]+/.exec(i[t])[0].replace("/","")?(r+=i[t],u||f--):i[t].search(/<\w/)>-1&&i[t].search(/<\//)==-1&&i[t].search(/\/>/)==-1?r=r+=u?i[t]:this.shift[f++]+i[t]:i[t].search(/<\w/)>-1&&i[t].search(/<\//)>-1?r=r+=u?i[t]:this.shift[f]+i[t]:i[t].search(/<\//)>-1?r=r+=u?i[t]:this.shift[--f]+i[t]:i[t].search(/\/>/)>-1?r=r+=u?i[t]:this.shift[f]+i[t]:r+=i[t].search(/<\?/)>-1?this.shift[f]+i[t]:i[t].search(/xmlns\:/)>-1||i[t].search(/xmlns\=/)>-1?this.shift[f]+i[t]:i[t];return r[0]=="\n"?r.slice(1):r},xmlmin:function(n){var t=this.preserveComments?n:n.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns");return t.replace(/>\s{0,}</g,"><")},json:function(n){return typeof JSON=="undefined"?n:typeof n=="string"?JSON.stringify(JSON.parse(n),null,this.step):typeof n=="object"?JSON.stringify(n,null,this.step):n},jsonmin:function(n){return typeof JSON=="undefined"?n:JSON.stringify(JSON.parse(n),null,0)},css:function(n){for(var i=n.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),f=i.length,r=0,u="",t=0,t=0;t<f;t++)u+=/\{/.exec(i[t])?this.shift[r++]+i[t]:/\}/.exec(i[t])?this.shift[--r]+i[t]:/\*\\/.exec(i[t])?this.shift[r]+i[t]:this.shift[r]+i[t];return u.replace(/^\n{1,}/,"")},cssmin:function(n){var t=this.preserveComments?n:n.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"");return t.replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},sql:function(n){for(var h=n.replace(/\s{1,}/g," ").replace(/\'/ig,"~::~'").split("~::~"),c=h.length,i=[],f=0,e=this.step,o=0,s="",t=0,t=0;t<c;t++)i=t%2?i.concat(h[t]):i.concat(u(h[t],e));for(c=i.length,t=0;t<c;t++)o=r(i[t],o),/\s{0,}\s{0,}SELECT\s{0,}/.exec(i[t])&&(i[t]=i[t].replace(/\,/g,",\n"+e+e+"")),/\s{0,}\s{0,}SET\s{0,}/.exec(i[t])&&(i[t]=i[t].replace(/\,/g,",\n"+e+e+"")),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(i[t])?(f++,s+=this.shift[f]+i[t]):/\'/.exec(i[t])?(o<1&&f&&f--,s+=i[t]):(s+=this.shift[f]+i[t],o<1&&f&&f--);return s.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},sqlmin:function(n){return n.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")}};n.fn.format=function(i){var r=new t(i);return this.each(function(){var i=n(this),t=i.val();t=r.format(t);i.val(t)})};n.format=function(n,i){var r=new t(i);return r.format(n)};n.fn.format.defaults={method:"xml",step:"    ",preserveComments:!1}})(jQuery);
