var _blockMessage=null,t_projstate_log_timeline_Obj=function(){"use strict";var t="//127.0.0.1/sara.dd.ldsw/service/service_t_projstate_log.asmx/",n="",i=["icon-quote-right","icon-pencil","icon-camera","icon-facetime-video","icon-time","glyphicon glyphicon-gbp","glyphicon glyphicon-flash"],r="",f=function(i){doAjaxFunction(t,"getXmmcByMaintableSysId",JSON.stringify({maintable_sys_id:n}),{success:function(n){$("#title_h1").html(n);i!=undefined&&i!=null&&i.success()},fail:function(n){_blockMessage.show("doTitle_t_projstate_log_timeline执行失败<br/>"+n,"fail")}})},e=function(t){n=requestQuery("fk_tbl_maintable_sys_id");n?t.success():_blockMessage.show("maintablesysid参数接收失败","fail")},o=function(r){doAjaxFunction(t,"getLogByMaintableSysId",JSON.stringify({maintable_sys_id:n}),{success:function(n){for(var t,e,f=new Function("","return "+n)(),o="",u=0;u<f.length;u++)t='<li class="unactive">',t+='<div class="timeline-time">',e=f[u].sys_creatdate.toDateTime(),t+="<strong>"+e.Format("yyyy-MM-dd")+"<\/strong>"+e.Format("hh:mm:ss")+"",t+="<\/div>",t+='<div class="timeline-icon">',t+='    <div class="bg-success">',t+='        <i class="'+i[u%i.length]+'"><\/i>',t+="    <\/div>",t+="<\/div>",t+='<div class="timeline-content">',t+="    <h2>",t+="   "+f[u].sys_creatusername,t+="    <\/h2>",t+="<h3>     "+f[u].fromstate+"→"+f[u].tostate+"<\/h3>",t+='    <div style="height:100px;">',t+="        "+f[u].remark+"",t+="    <\/div>",t+="<\/div>",t+="<\/li>",o+=t;$("#log_ul").html(o);r!=undefined&&r!=null&&r.success()},fail:function(n){_blockMessage.show("initLog_t_projstate_log_timeline执行失败<br/>"+n,"fail")}})},u=function(){return $(".timeline.animated li.unactive").each(function(){var n,t;return n=$(this).position().top+$(this).outerHeight(),t=$(window).scrollTop()+$(window).height(),t>n?($(this).removeClass("unactive"),$(this).addClass("active")):void 0})};return{init:function(){_blockMessage=new blockMessage;e({success:function(){f({success:function(){o({success:function(){u();$(window).scroll(function(){var n=$(window).scrollTop();if(n-r>50)return r=n,u()})}})}})}})}}}();$(document).ready(t_projstate_log_timeline_Obj.init);