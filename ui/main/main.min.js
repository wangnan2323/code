$(document).ready(function(){mainObject.initMain()});var _blockMessage=null,_contentMessage=null,_alertMessage=null,_pr_appcode="54",_clientInf='{userid:"",appcode:"54",appname:"",userip:"",usermac:"",username:""}',mainObject=function(){"use strict";var n={_serviceUrl_main:"//127.0.0.1/sara.dd.ldsw/service/service_main.asmx/",_serviceUrl_tbl_maintable_detailall:"//127.0.0.1/sara.dd.ldsw/service/service_tbl_maintable_detailall.asmx/",_commonColorCssArray:["color1","color2","color3","color4","color5","color6","color7","color8","color9","color10"],_commonIconCssArray:["icon-compass","icon-trello","icon-beer","icon-bell","icon-calendar-empty","icon-dashboard","icon-key","icon-legal","icon-group","icon-crop"],_widgetConfigString:"",_widgetInitStatus:{news:!1,comment:!1,notebook:!1,support:!1,workitem:!1},allComplete:function(){n._widgetInitStatus.comment!=!1&&n._widgetInitStatus.news!=!1&&n._widgetInitStatus.notebook!=!1&&n._widgetInitStatus.support!=!1&&(n.initSocialWidget(),n.initLayOut(),n.setSocialWidgetHeight(!0))},initMain:function(){_contentMessage=new contentMessage;_alertMessage=new alertMessage;_blockMessage=new blockMessage;_blockMessage.show("程序加载中...","loading");n.setSocialWidgetHeight(!1);basePageObj.initBasePage({success:function(){n.initParameter({success:function(){_blockMessage.hidden();n.initUserInfo();("^"+n._widgetConfigString+"^").indexOf("^workitem^")<0?(n._widgetInitStatus.workitem=null,n.allComplete()):n.initWorkitem({success:function(){n._widgetInitStatus.workitem=!0;n.setWorkitemWidgetCount();n.allComplete()}});("^"+n._widgetConfigString+"^").indexOf("^comment^")<0?(n._widgetInitStatus.comment=null,n.allComplete()):n.initComment({success:function(){n._widgetInitStatus.comment=!0;n.setCommentWidgetCount();n.allComplete()}});("^"+n._widgetConfigString+"^").indexOf("^news^")<0?(n._widgetInitStatus.news=null,n.allComplete()):n.initNewsContent({success:function(){n.onScrollNewsContent();n.spyScrollNewsContent();n._widgetInitStatus.news=!0;n.setNewsWidgetCount();n.allComplete()}});("^"+n._widgetConfigString+"^").indexOf("^notebook^")<0?(n._widgetInitStatus.notebook=null,n.allComplete()):n.initNoteBook({success:function(){n._widgetInitStatus.notebook=!0;n.setNoteBookWidgetCount();n.allComplete()}});("^"+n._widgetConfigString+"^").indexOf("^support^")<0?(n._widgetInitStatus.support=null,n.allComplete()):n.initSupport({success:function(){n._widgetInitStatus.support=!0;n.setSupportWidgetCount();n.allComplete()}})}})},fail:function(n){_blockMessage.show(n,"fail")}})},initParameter:function(t){_pr_appcode=requestQuery("appcode");n._pr_workitemsearchcontent=requestQuery("workitemsearchcontent");_clientInf=JSON.stringify({userid:basePageObj._userInfoJson.sys_userid,appcode:_pr_appcode,appname:"",userip:basePageObj._userInfoJson.ip,usermac:basePageObj._userInfoJson.mac,username:basePageObj._userInfoJson.sys_username});n._pr_workitemsearchcontent!==undefined&&n._pr_workitemsearchcontent!=null&&$("#txt_workitemSearch_main").val(n._pr_workitemsearchcontent);t.success()},initUserInfo:function(){var i="",t,r,u;i+=basePageObj._userInfoJson.sys_photourl==""?'<img style="border-radius:50%;" class="img-usericon-main" src="//162.16.166.1/sara.resource.library/images/currentUser.png" />':'<img style="border-radius:50%;" class="img-usericon-main" src="//127.0.0.1/sara.dd.ldsw.file/files_auth/fileuploadpath/'+basePageObj._userInfoJson.sys_photourl+'" />';$("#txt_username_main").html(' <i class="icon-signout i-logout" onclick="basePageObj.btn_logOut_onclick();" href="javascript:void(0);"><\/i>'+basePageObj._userInfoJson.sys_username+"/"+basePageObj._userInfoJson.sys_userloginname+i);$("#txt_userorgan_main").html(basePageObj._userInfoJson.sys_toporganname+"/"+basePageObj._userInfoJson.sys_organname);$("#txt_userposition_main").html(basePageObj._userInfoJson.sys_positionnames.replaceAll("^","，"));$("#txt_userrole_main").html(basePageObj._userInfoJson.sys_rolenames.replaceAll("^","，"));$("#txt_macip_main").html("mac地址:"+basePageObj._userInfoJson.mac+"<br/>ip地址:"+basePageObj._userInfoJson.ip);t=basePageObj.getUserCookie();r="sp-"+t.theme;$("#"+r).addClass("sp-themeSelected");$(".div-detailallmode").removeClass("active");$("#div_detailallmode"+t.detailAllMode).addClass("active");n._widgetConfigString=basePageObj.getUserCookie().widgetConfig;n._widgetConfigString||(n._widgetConfigString="workitem^comment^notebook^news^support");u=n._widgetConfigString.split("^");$.each(u,function(n,t){var i,r;$("#div_widgetconfig_"+t).find("b").addClass("active");i=$('#div_socialwidgetContent_main>.social-widget[socialwidgettype="'+t+'"]');i.removeClass("hidden");r=$('div[layoutwidgettype="'+t+'"]');r.removeClass("hidden")})},clickUserInfoSelectTheme:function(n){var t=$(n).parent().parent().children();$.each(t,function(n){$(t[n]).removeClass("sp-themeSelected")});$(n).parent().addClass("sp-themeSelected")},setDetailAllMode:function(n){var t=basePageObj.getUserCookie().detailAllMode;t||(t="2");t!=n&&(basePageObj.setUserCookie([{detailAllMode:n}]),$(".div-detailallmode").removeClass("active"),$("#div_detailallmode"+n).addClass("active"))},checkWidgetConfig:function(t){var f=$("#div_widgetconfig_"+t),i,r,u;if(!f.hasClass("disabled")){if(i=f.find("b"),i.hasClass("active"))i.removeClass("active"),n._widgetConfigString=("^"+n._widgetConfigString+"^").replaceAll("^"+t+"^","^"),r=$('#div_socialwidgetContent_main>.social-widget[socialwidgettype="'+t+'"]'),r.addClass("hidden"),u=$('div[layoutwidgettype="'+t+'"]'),u.addClass("hidden");else{i.addClass("active");n._widgetConfigString=n._widgetConfigString+"^"+t;r=$('#div_socialwidgetContent_main>.social-widget[socialwidgettype="'+t+'"]');r.removeClass("hidden");u=$('div[layoutwidgettype="'+t+'"]');u.removeClass("hidden");switch(t){case"workitem":n._widgetInitStatus.workitem===null&&n.initWorkitem({success:function(){n._widgetInitStatus.workitem=!0;n.setWorkitemWidgetCount()}});break;case"comment":n._widgetInitStatus.comment===null&&n.initComment({success:function(){n._widgetInitStatus.comment=!0;n.setCommentWidgetCount()}});break;case"news":n._widgetInitStatus.news===null&&n.initNewsContent({success:function(){n._widgetInitStatus.news=!0;n.setNewsWidgetCount()}});break;case"notebook":n._widgetInitStatus.notebook===null&&n.initNoteBook({success:function(){n._widgetInitStatus.notebook=!0;n.setNoteBookWidgetCount()}});break;case"support":n._widgetInitStatus.support===null&&n.initSupport({success:function(){n._widgetInitStatus.support=!0;n.setSupportWidgetCount()}})}}n.setSocialWidgetHeight(!0);n.scrollToUserInf();n._widgetConfigString=n._widgetConfigString.replaceAll("^^","^").trimStart("^").trimEnd("^");basePageObj.setUserCookie([{widgetConfig:n._widgetConfigString}])}},scrollToUserInf:function(){try{$(window).scrollTop($("#div_userInfContentCol_main").offset().top-200)}catch(n){$("html,body").animate({scrollTop:$("#div_userInfContentCol_main").offset().top-200},100)}},_ladda_btn_workitemsearch:null,_pr_workitemsearchcontent:"",_workitemJsonHashMap:null,_workitemDataStartIndex:0,_workitemDataStep:50,_isWorkitemMeunLoaded:!1,_workitemResultJson:null,initWorkitem:function(t){n._ladda_btn_workitemsearch=Ladda.create("btn_workitemsearch_main");n._workitemJsonHashMap=null;n._workitemJsonHashMap=new hashMap;n.workitemDoAjax(n._workitemDataStep,{success:function(i){var r="";r+="";$.each(i.customColumnJsonArray,function(n){r+="、"+i.customColumnJsonArray[n].columnText});$("#txt_workitemSearch_main").attr("placeholder",r);n.workitemCreatMenuContentString(i.menuJsonArray);n.workitemCreatCardString(i.customColumnJsonArray,i.contentJsonArray,i.contentCount);n._workitemResultJson=i;t.success()}})},workitemCreatMenuContentString:function(t){var r="",i="";$.each(t,function(u){var h=u%n._commonColorCssArray.length,o=n._commonColorCssArray[h],c=n._commonIconCssArray[h],f=t[u].projectclassid,l=t[u].projectclassid_name,s=t[u].count,e=t[u].children;n._isWorkitemMeunLoaded==!1&&(r+=s=="0"||s==0?'<a class="btnC btn-circle btn-'+o+' unchecked"  disabled="disabled"  projectclassid="'+f+'" >':'<a class="btnC btn-circle btn-'+o+'" onclick="mainObject.clickWorkitemMenu(this);" projectclassid="'+f+'" >',r+='<i class="'+c+'"><\/i>'+l,r+='<b class="badge bg-'+o+'">'+s+"<\/b>",r+="<\/a>");i+="<div>";i+='<h2 class="h2-title-main" id="h2_'+f+'" style="display:none;">';i+='<table  class="table table-filters">';i+="<tbody>";i+="<tr>";i+='<td class="filter-category '+o+' td-width60-main">';i+='<div class="arrow-left"><\/div>';i+='<i class="'+c+'"><\/i>';i+="<\/td>";i+='<td class="td-left-main">';i+='<a id="a_'+f+'">';i+=l;i+="<\/a>";i+="<\/td>";i+="<\/tr>";i+="<\/tbody>";i+="<\/table>";i+="<\/h2>";e!=null&&$.each(e,function(n){var t=e[n].projectclassdtl2,r=e[n].projectclassdtl2_name,u=e[n].count;i+='<div id="a_'+f+"_"+t+'" style="display:none;text-align:right;"  class="h3-title-main">'+r+"<\/div>";i+='<div id="div_'+f+"_"+t+'" style="display:none;" class="div-content-main"><img class="imgloading-main" src="../../images/loading.gif" /><\/div>'});i+="<\/div>"});n._isWorkitemMeunLoaded==!1&&($("#div_workitemMenu_main").html(r),n._isWorkitemMeunLoaded=!0);$("#div_workitemContent_main").html(i)},workitemCreatCardString:function(t,i,r){if($.each(i,function(r){if(i[r].tbl_maintable_sys_id=="-1")return!0;n._workitemJsonHashMap.put(i[r].tbl_maintable_sys_id,i[r]);var u="";u+=n._workitemDataStartIndex%2>0?i[r].lzlx.indexOf("-")>-1?'<div class="well0-main bak-main">':'<div class="well0-main">':i[r].lzlx.indexOf("-")>-1?'<div class="well1-main bak-main">':'<div class="well1-main">';n._workitemDataStartIndex++;u+='<div class="row div-workitem-item-title" style="margin: 0px 0px 0px !important;">';u+='<div class="col-xs-6">';u+='<h3 class="h3-content-main">';u+=i[r].sys_first=="0"?'<strong><a class="hand" onclick="mainObject.clickWorkitemTransPage(\''+i[r].tbl_maintable_sys_id+"');\">"+i[r].xmmc+"<\/a><\/strong>":'<a class="hand" onclick="mainObject.clickWorkitemTransPage(\''+i[r].tbl_maintable_sys_id+"');\">"+i[r].xmmc+"<\/a>";u+="/";u+="<small>"+i[r].receivetime+"<\/small>";u+="<\/h3>";u+="<\/div>";u+='<div  class="col-xs-6 div-right-main">';u+=n.workitemGetButtonString(i,r);u+="<\/div>";u+="<\/div>";u+='<blockquote  class="blockquote-main">';u+='<div class="row">';$.each(t,function(n){u+='<div class="col-md-3">';u+='<p class="fontsize-small-main">';u+="<strong>"+t[n].columnText+"：<\/strong>";i[r][t[n].columnField]!=undefined&&i[r][t[n].columnField]!=""&&(u+=""+i[r][t[n].columnField]+"");u+="<\/p>";u+="<\/div>"});t.length%2==1&&(u+='<div class="col-md-3">',u+='<p class="fontsize-small-main">',u+="<strong>&nbsp;&nbsp;<\/strong>",u+="<\/p>",u+="<\/div>");u+='<div class="col-md-3">';u+='<p class="fontsize-small-main">';u+="<strong>业务状态：<\/strong>";u+=i[r].lzlx.indexOf("-")>-1?"<code>"+i[r].projectclassdtl1_name+"<\/code>":""+i[r].projectclassdtl1_name+"";u+="<\/p>";u+="<\/div>";u+='<div class="col-md-3">';u+='<p class="fontsize-small-main">';u+="<strong>流转类型：<\/strong>";u+=i[r].lzlx.indexOf("-")>-1?"<code>"+i[r].lzlx.replaceAll("-","")+"<\/code>":""+i[r].lzlx+"";u+="<\/p>";u+="<\/div>";u+='<div class="col-md-3">';u+='<p class="fontsize-small-main">';u+="<strong>数据状态：<\/strong>";u+=""+i[r].projectclassdtl2_name+"";u+="<\/p>";u+="<\/div>";u+="<\/div>";u+="<\/blockquote>";u+="<\/div>";$("#div_"+i[r].projectclassid+"_"+i[r].projectclassdtl2+" .imgloading-main").remove();$("#div_"+i[r].projectclassid+"_"+i[r].projectclassdtl2).append(u);$("#div_"+i[r].projectclassid+"_"+i[r].projectclassdtl2).css("display","");$("#a_"+i[r].projectclassid+"_"+i[r].projectclassdtl2).css("display","");$("#h2_"+i[r].projectclassid).css("display","")}),i.length<r){var u='<div id="btn_workitemloadmore_main" onclick="mainObject.clickWorkitemLoadMore();" class="btn btn-lg btn-default-outline btn-block">加载全部待办工作共'+r+"条<\/div>";$("#div_workitemLoadAll_main").html(u)}},workitemDoAjax:function(t,i){var r={sysUserIdString:basePageObj._userInfoJson.sys_userid,searchTextString:$("#txt_workitemSearch_main").val(),stratIndexString:n._workitemDataStartIndex,userInfoJsonString:basePageObj._userInfoJson},u;r.endIndexString=t=="-1"?"-1":n._workitemDataStartIndex+t;u={parameterJsonString:JSON.stringify(r),clientInf:_clientInf};doAjaxFunction(n._serviceUrl_main,"GetWorkItem",u,{success:function(n){var t=new Function("","return "+n)();t.menuJsonArray=t.menuJsonArray.toString().toJson();t.menuJsonArray==null&&(t.menuJsonArray=[]);$.each(t.menuJsonArray,function(n){t.menuJsonArray[n].children=t.menuJsonArray[n].children.toString().toJson()});t.contentJsonArray=t.contentJsonArray.toString().toJson();t.contentJsonArray==null&&(t.contentJsonArray=[]);t.customColumnJsonArray=t.customColumnJsonArray.toString().toJson();t.customColumnJsonArray==null&&(t.customColumnJsonArray=[]);i.success(t)},fail:function(t){_blockMessage.show(n._serviceUrl_main+"GetWorkItem<br/>"+t,"fail")},error:function(t){_blockMessage.show(n._serviceUrl_main+"GetWorkItem<br/>"+t,"fail")}})},workitemGetButtonString:function(n,t){var i="";return i+='<a class="a-size-large-main hand" onclick="mainObject.clickWorkitemTransPage(\''+n[t].tbl_maintable_sys_id+'\');" title="操作">',i+='<i class="glyphicon glyphicon-edit"><\/i>',i+="<\/a>",i+="&nbsp;&nbsp;&nbsp;&nbsp;",i+='<a class="a-size-large-main hand" onclick="mainObject.clickWorkitemViewLog(\''+n[t].tbl_maintable_sys_id+'\');" title="审核意见">',i+='<i class="glyphicon glyphicon-list-alt"><\/i>',i+"<\/a>"},clickWorkitemViewMap:function(){},clickWorkitemViewLog:function(n){var t="../t_projstate_log/t_projstate_log_timeline.html";t+="?uid="+basePageObj._userInfoJson.sys_userid;t+="&fk_tbl_maintable_sys_id="+n;t+="&listtype=2";t+="&random="+parseInt(1e4*Math.random());window.open(t)},clickWorkitemTransPage:function(t){var r=n._workitemJsonHashMap.get(t),i="",u,f,e;i+=r.appurl;u=r.appparameter.split("^");$.each(u,function(n){i+=n==0?"?":"&";var f=u[n].replaceAll("[tbl_maintable_sys_id]",t);f=f.replaceAll("[userid]",basePageObj._userInfoJson.sys_userid);f=f.replaceAll("[projectclassid]",r.projectclassid);f=f.replaceAll("[projectclassdtl1]",r.projectclassdtl1);f=f.replaceAll("[projectclassdtl2]",r.projectclassdtl2);f=f.replaceAll("[pagetype]","1");f=f.replaceAll("[appcode]",_pr_appcode);i+=f});i+="&fromurl=../main/main.html";i+="&fromurlparam={";i+='"workitemsearchcontent":"'+$("#txt_workitemSearch_main").val()+'"';i+="}";f={mainTableSysidString:t};e={parameterJsonString:JSON.stringify(f),clientInf:_clientInf};doAjaxFunction(n._serviceUrl_tbl_maintable_detailall,"UpDataSysFirst",e,{success:function(){commonObj.changeUrl(i,"right-show")},fail:function(n){_alertMessage.show("操作失败<br/>"+n,"fail")},error:function(n){_alertMessage.show("操作失败<br/>"+n.message,"fail")}})},clickWorkitemLoadMore:function(){$("#btn_workitemloadmore_main").attr("disabled","disabled");$("#btn_workitemloadmore_main").text("数据装载中...");n.workitemDoAjax("-1",{success:function(t){setTimeout(function(){n.workitemCreatCardString(t.customColumnJsonArray,t.contentJsonArray,t.contentCount);n._workitemResultJson=t;$("#btn_workitemloadmore_main").remove()},100)}})},btn_workitemsearch_main_onclick:function(){n._ladda_btn_workitemsearch.start();n._workitemDataStartIndex=0;$("#btn_workitemloadmore_main")&&$("#btn_workitemloadmore_main").remove();n._workitemJsonHashMap=null;n._workitemJsonHashMap=new hashMap;n.workitemDoAjax(n._workitemDataStep,{success:function(t){$("#div_workitemContent_main").html("");n.workitemCreatMenuContentString(t.menuJsonArray);n.workitemCreatCardString(t.customColumnJsonArray,t.contentJsonArray,t.contentCount);$(".btnC.btn-circle").removeClass("unchecked");n._ladda_btn_workitemsearch.stop()}})},clickWorkitemMenu:function(n){var t=$.grep($(n).parent().children(),function(n){return $(n).find("b").text()=="0"?!1:!0}),i=$(n).attr("projectclassid"),r;$(n).hasClass("unchecked")?($(n).removeClass("unchecked"),$("#h2_"+i).parent().removeClass("hidden")):(r=$.grep($(".btnC.btn-circle.unchecked"),function(n){return $(n).find("b").text()=="0"?!1:!0}).length,r==0?$.each(t,function(n){var r=$(t[n]).attr("projectclassid");r!=i&&($(t[n]).addClass("unchecked"),$("#h2_"+r).parent().addClass("hidden"))}):t.length-1==r?$.each(t,function(n){var r=$(t[n]).attr("projectclassid");r!=i&&($(t[n]).removeClass("unchecked"),$("#h2_"+r).parent().removeClass("hidden"))}):($(n).addClass("unchecked"),$("#h2_"+i).parent().addClass("hidden")))},setWorkitemWidgetCount:function(){n._workitemResultJson.contentCount=="0"?($("#b_workitemCount").addClass("bg-colorGray"),$("#b_workitemCount").removeClass("bg-colorRed")):($("#b_workitemCount").removeClass("bg-colorGray"),$("#b_workitemCount").addClass("bg-colorRed"));$("#b_workitemCount").html(n._workitemResultJson.contentCount)},_commentContentJson:null,initComment:function(t){var i={appcodeIdString:_pr_appcode,sysUserIdString:basePageObj._userInfoJson.sys_userid,userInfoJsonString:basePageObj._userInfoJson},r={parameterJsonString:JSON.stringify(i),clientInf:_clientInf};doAjaxFunction(n._serviceUrl_main,"GetComment",r,{success:function(i){n._commentContentJson=new Function("","return "+i)();n.renderComment();n.setCommentWidgetCount();t.success()},fail:function(t){_blockMessage.show(n._serviceUrl_main+"GetComment<br/>"+t,"fail")},error:function(t){_blockMessage.show(n._serviceUrl_main+"GetComment<br/>"+t,"fail")}})},renderComment:function(){var t="",r=basePageObj.getUserCookie().readedCommentIds,i;r||(r="");i="";$.each(n._commentContentJson.rows,function(n,u){var f,e;("^"+r+"^").indexOf("^"+_pr_appcode+"_"+u.sys_id+"^")>-1?(t+="<li>",t+='    <img width="30" height="30" src="//162.16.166.1/sara.resource.library/images/adminUser.png" />',t+='    <div class="bubble">',t+='        <a class="user-name" onclick="mainObject.clickCommentTitle(this);">【+】'+u.f_title+"<\/a>",t+='        <div class="message hidden">',t+=u.f_content_dtl+"<br/>",u.f_filerealname!=""&&(f=u.f_filerealname.split(","),e=u.f_fileuploadname.split(","),f.length>0&&(t+="<strong>相关附件：<\/strong><br>",$.each(f,function(n){t+='<a href="'+html5fileuploader_DefaultOps.fileUploadRootPath+"fileuploadpath/"+e[n]+'" target="_blank">'+f[n]+"<\/a><br>"}))),t+="        <\/div>",t+='        <p class="time hidden">',t+="            <strong>"+u.sys_creatusername+"<\/strong>&nbsp;&nbsp;&nbsp;&nbsp;"+u.f_act_startdate.toDateTime().Format("yyyy-MM-dd")+"&nbsp;&nbsp;&nbsp;&nbsp;",t+="        <\/p>",t+="    <\/div>",t+="<\/li>"):(i+=u.sys_id+"^",t+='<li class="current-user">',t+='    <img width="30" height="30" src="//162.16.166.1/sara.resource.library/images/adminUser1.png"   />',t+='    <div class="bubble"  title="点击标记已读" commentid='+u.sys_id+' onclick="mainObject.clickCommentItem(this);">',t+='        <a class="user-name">'+u.f_title+"<\/a>",t+='        <div class="message">',t+=u.f_content_dtl+"<br/>",u.f_filerealname!=""&&(f=u.f_filerealname.split(","),e=u.f_fileuploadname.split(","),f.length>0&&(t+="<strong>相关附件：<\/strong><br>",$.each(f,function(n){t+='<a href="'+html5fileuploader_DefaultOps.fileUploadRootPath+"fileuploadpath/"+e[n]+'" target="_blank">'+f[n]+"<\/a><br>"}))),t+="        <\/div>",t+='        <p class="time">',t+="            <strong>"+u.sys_creatusername+"<\/strong>&nbsp;&nbsp;&nbsp;&nbsp;"+u.f_act_startdate.toDateTime().Format("yyyy-MM-dd")+"&nbsp;&nbsp;&nbsp;&nbsp;",t+="        <\/p>",t+="    <\/div>",t+="<\/li>")});$("#ul_commentContainer_main").html(t);n._commentContentJson.unReadedCount=i==""?0:i.trimEnd("^").split("^").length},clickCommentItem:function(t){var i=basePageObj.getUserCookie().readedCommentIds,r;i||(i="");r=$(t).attr("commentid");("^"+i+"^").indexOf("^"+_pr_appcode+"_"+r+"^")>-1||(i+="^"+_pr_appcode+"_"+r);basePageObj.setUserCookie([{readedCommentIds:i.trimStart("^")}]);n.renderComment();n.setCommentWidgetCount();n.setSocialWidgetHeight(!0)},clickCommentTitle:function(t){var i=$(t).parent().children(".message"),r=$(t).parent().children(".time");i.hasClass("hidden")?(i.removeClass("hidden"),r.removeClass("hidden"),$(t).html($(t).html().replaceAll("【+】","【-】"))):(i.addClass("hidden"),r.addClass("hidden"),$(t).html($(t).html().replaceAll("【-】","【+】")));n.setSocialWidgetHeight(!0)},setCommentWidgetCount:function(){n._commentContentJson.unReadedCount!="0"?($("#b_commentCount").removeClass("bg-colorGray"),$("#b_commentCount").addClass("bg-colorRed"),$("#b_commentCount").html(n._commentContentJson.unReadedCount+"/"+n._commentContentJson.total),$("#b_commentCount").parent().parent().parent().parent().parent().removeClass("unchecked"),$("#div_comment_main").removeClass("hidden"),$(".icon-volume-up").addClass("tada")):($("#b_commentCount").addClass("bg-colorGray"),$("#b_commentCount").removeClass("bg-colorRed"),$("#b_commentCount").html(n._commentContentJson.total),$("#b_commentCount").parent().parent().parent().parent().parent().addClass("unchecked"),$("#div_comment_main").addClass("hidden"),$(".icon-volume-up").removeClass("tada"))},_lastscrollTop_newsContent:0,_newsContentJson:null,_newsPageIndexString:1,_newsPageSizeString:10,initNewsContent:function(t){var i={appcodeIdString:_pr_appcode,pageIndexString:n._newsPageIndexString,pageSizeString:n._newsPageSizeString,sysUserIdString:basePageObj._userInfoJson.sys_userid,userInfoJsonString:basePageObj._userInfoJson},r={parameterJsonString:JSON.stringify(i),clientInf:_clientInf};doAjaxFunction(n._serviceUrl_main,"GetNews",r,{success:function(i){n._newsContentJson=new Function("","return "+i)();var r="";$.each(n._newsContentJson.rows,function(t,i){var u=t%n._commonColorCssArray.length,f=n._commonColorCssArray[u],e=n._commonIconCssArray[u];r+='<li class="unactive">';r+='    <div class="timeline-time">';r+=""+i.f_title+"<strong>"+i.f_date.toDateTime().Format("yyyy-MM-dd")+"<\/strong>";r+="    <\/div>";r+='    <div class="timeline-icon">';r+='        <div class="timeline-icon-'+f+'">';r+='            <i class="'+e+'"><\/i>';r+="        <\/div>";r+="    <\/div>";r+='    <div class="timeline-content"  style="padding:10px !important;">';r+='        <a style="font-size:14px;">'+i.f_title+"<\/a>";r+="        <div>";r+=i.f_content_dtl+"<br/>";r+="<strong>操作人：<\/strong>"+i.f_czr+"<br/>";r+="        <\/div>";r+="    <\/div>";r+="<\/li>"});$("#ul_news").append(r);n._newsPageIndexString*n._newsPageSizeString>=n._newsContentJson.total?$("#btn_newsloadmore_main").addClass("hidden"):$("#btn_newsloadmore_main").removeClass("hidden");t.success()},fail:function(t){_blockMessage.show(n._serviceUrl_main+"GetNews<br/>"+t,"fail")},error:function(t){_blockMessage.show(n._serviceUrl_main+"GetNews<br/>"+t,"fail")}})},spyScrollNewsContent:function(){$("#div_newsContent_main").scroll(function(){var t=$("#div_newsContent_main").scrollTop();if(t-n._lastscrollTop_newsContent>50)return n._lastscrollTop_newsContent=t,n.onScrollNewsContent()})},onScrollNewsContent:function(){return $(".timeline.animated li.unactive").each(function(){var n,t;return n=$(this).position().top+$(this).outerHeight()-100,t=$("#div_newsContent_main").scrollTop()+$("#div_newsContent_main").height(),t>n?($(this).removeClass("unactive"),$(this).addClass("active")):void 0})},setNewsWidgetCount:function(){$("#b_newsCount").html(n._newsContentJson.total)},clickNewsLoadMore:function(){n._newsPageIndexString=n._newsPageIndexString+1;$("#btn_newsloadmore_main").attr("disabled","disabled");$("#btn_newsloadmore_main").text("数据装载中...");n.initNewsContent({success:function(){n._newsPageIndexString*n._newsPageSizeString>=n._newsContentJson.total?$("#btn_newsloadmore_main").addClass("hidden"):($("#btn_newsloadmore_main").removeClass("hidden"),$("#btn_newsloadmore_main").removeAttr("disabled"),$("#btn_newsloadmore_main").text("继续加载"))}})},_isFirstLoadData:!0,_noteBookContentJson:null,initNoteBook:function(t){$("#div_notebook").fullCalendar({header:{left:"prev,next",center:"title",right:"month,agendaWeek,agendaDay"},editable:!1,droppable:!1,monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["周日","周一","周二","周三","周四","周五","周六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],today:["今天"],buttonText:{today:"今日",month:"月",week:"周",day:"日",prev:"<",next:">"},contentHeight:400,firstDay:0,aspectRatio:1,dayClick:function(){},eventClick:function(n){var t="<h3>"+n.content.header+"<small><\/small><\/h3>",i,r;t+="<strong>描述：<\/strong>";t+=n.content.content+"<br/>";t+="<br/>";n.content.filerealname!=""&&(i=n.content.filerealname.split(","),r=n.content.fileuploadname.split(","),i.length>0&&(t+="<strong>相关附件：<\/strong><br>",$.each(i,function(n){t+='<a href="'+html5fileuploader_DefaultOps.fileUploadRootPath+"fileuploadpath/"+r[n]+'" target="_blank">'+i[n]+"<\/a><br>"})));t+="<strong>开始时间：<\/strong>"+n.content.start.toDateTime().Format("yyyy-MM-dd")+"&nbsp;&nbsp;&nbsp;&nbsp;";t+="<strong>结束时间：<\/strong>"+n.content.end.toDateTime().Format("yyyy-MM-dd")+"<br/>";t+="<strong>发起人：<\/strong>"+n.content.czr+"<br/>";t+="<strong>范围：<\/strong>"+n.content.group;_contentMessage.show(n.title,t)},viewDisplay:function(t){n._isFirstLoadData||n.bindNoteBook(t.visStart,t.visEnd)}});n._isFirstLoadData=!1;var i=$("#div_notebook").fullCalendar("getView");n.bindNoteBook(i.visStart,i.visEnd,t)},bindNoteBook:function(t,i,r){$("#div_notebook").fullCalendar("removeEvents");var u={appcodeIdString:_pr_appcode,startDateString:t.Format("yyyy-MM-dd"),endDateString:i.Format("yyyy-MM-dd"),sysUserIdString:basePageObj._userInfoJson.sys_userid,userInfoJsonString:basePageObj._userInfoJson},f={parameterJsonString:JSON.stringify(u),clientInf:_clientInf};doAjaxFunction(n._serviceUrl_main,"GetNoteBook",f,{success:function(t){n._noteBookContentJson=new Function("","return "+t)();$.each(n._noteBookContentJson.rows,function(n,t){var i=n%6+1;$("#div_notebook").fullCalendar("renderEvent",{id:t.sys_id,title:t.f_title,start:new Date(t.f_date1.replace(/-/g,"/")),end:new Date(t.f_date2.replace(/-/g,"/")),allDay:!0,content:{header:t.f_title,content:t.f_content,start:t.f_date1,end:t.f_date2,czr:t.f_czr,group:t.f_group,filerealname:t.f_filerealname,fileuploadname:t.f_fileuploadname},className:"label label-color"+i},!0)});r&&r.success()},fail:function(t){_blockMessage.show(n._serviceUrl_main+"GetNoteBook<br/>"+t,"fail")},error:function(t){_blockMessage.show(n._serviceUrl_main+"GetNoteBook<br/>"+t,"fail")}})},setNoteBookWidgetCount:function(){$("#b_notebookCount").html(n._noteBookContentJson.total)},_supportContentJson:null,initSupport:function(t){var i={appcodeIdString:_pr_appcode,sysUserIdString:basePageObj._userInfoJson.sys_userid,userInfoJsonString:basePageObj._userInfoJson},r={parameterJsonString:JSON.stringify(i),clientInf:_clientInf};doAjaxFunction(n._serviceUrl_main,"GetSupport",r,{success:function(i){n._supportContentJson=new Function("","return "+i)();var r="";$.each(n._supportContentJson.rows,function(n,t){r+=' <div class="panel">';r+=' <div class="panel-heading">';r+=' <div class="panel-title">';r+=' <a class="accordion-toggle" onclick="mainObject.clickSupportContentAccordionItem(this);" data-parent="#div_supportContentAccordion_main" data-toggle="collapse" href="#faq'+t.sys_id+'">';r+=' <div class="caret pull-right"><\/div>';r+=" "+t.f_title;r+=" <\/a>";r+=" <\/div>";r+=" <\/div>";r+=' <div class="panel-collapse collapse" id="faq'+t.sys_id+'">';r+=' <div class="panel-body">';r+=' <img src="../../images/loading.gif" />数据装载中...';r+=" <\/div>";r+=" <\/div>";r+=" <\/div>"});$("#div_supportContentAccordion_main").append(r);t.success()},fail:function(t){_blockMessage.show(n._serviceUrl_main+"GetSupport<br/>"+t,"fail")},error:function(t){_blockMessage.show(n._serviceUrl_main+"GetSupport<br/>"+t,"fail")}})},setSupportWidgetCount:function(){$("#b_supportCount").html(n._supportContentJson.total)},clickSupportContentAccordionItem:function(t){var i=$(t).attr("href");if($(i).find(".panel-body").html().indexOf("数据装载中...")>-1){var r=i.replaceAll("#faq",""),u={supportid:r},f={parameterJsonString:JSON.stringify(u),clientInf:_clientInf};doAjaxFunction(n._serviceUrl_main,"GetSupportContent",f,{success:function(n){var r=new Function("","return "+n)(),t="",u,f;t+="<br/>";t+=r.rows[0].f_content_dtl;t+="<br/>";r.rows[0].f_filerealname!=""&&(u=r.rows[0].f_filerealname.split(","),f=r.rows[0].f_fileuploadname.split(","),u.length>0&&(t+="<strong>相关附件：<\/strong><br>",$.each(u,function(n){t+='<a href="'+html5fileuploader_DefaultOps.fileUploadRootPath+"fileuploadpath/"+f[n]+'" target="_blank">'+u[n]+"<\/a><br>"})));t+="<br/>";t+="<strong>发布人：<\/strong>"+r.rows[0].f_czr;$(i).find(".panel-body").html(t)},fail:function(){},error:function(){}})}},initLayOut:function(){$(window).height()<700?($("#div_workitemContent_main").height(500),$("#div_newsContent_main").height(500)):($("#div_workitemContent_main").height($(window).height()-400),$("#div_newsContent_main").height($(window).height()-400))},initSocialWidget:function(){var n,t;$(".social-widget").on("mouseover",function(){$(this).find('i[class*="icon-"]').addClass("pulse")});$(".social-widget").on("mouseout",function(){$(this).find('i[class*="icon-"]').removeClass("pulse")});n=$(window).width();n>basePageObj._padMinSrceenWidth&&(t=$("#div_socialwidgetContent_main").width(),setTimeout(function(){$("#div_socialwidgetContent_main").affix({offset:{top:100,bottom:100}});$("#div_socialwidgetContent_main").width(t)}))},setSocialWidgetHeight:function(n){n?$(window).width()>basePageObj._padMinSrceenWidth&&$("#div_socialwidget_main").height($(document).height()-110):$(window.top).width()>basePageObj._padMinSrceenWidth&&$("#div_socialwidget_main").height($(window.top).height()-110)},clickSocialWidgetItem:function(t){var r=$(".item.social-widget"),i=$(t).attr("socialwidgettype");switch(i){case"workitem":n.showContenCol(["div_workitemMenuCol_main","div_workitemContentCol_main"]);break;case"comment":$(t).hasClass("unchecked")?($(t).removeClass("unchecked"),$("#div_comment_main").removeClass("hidden"),$("#div_comment_main").addClass("fadeInDown animated infinite"),setTimeout(function(){$("#div_comment_main").removeClass("fadeInDown")},500),setTimeout(function(){try{$(window).scrollTop($("#div_comment_main").offset().top-200)}catch(n){$("html,body").animate({scrollTop:$("#div_comment_main").offset().top-200},100)}}),n.setSocialWidgetHeight(!0)):($(t).addClass("unchecked"),$("#div_comment_main").addClass("fadeOutUp animated infinite"),setTimeout(function(){$("#div_comment_main").removeClass("fadeOutUp");$("#div_comment_main").addClass("hidden");n.setSocialWidgetHeight(!0)},500));break;case"notebook":n.showContenCol(["div_notebookContentCol_main"]);break;case"news":n.showContenCol(["div_newsContentCol_main"]);break;case"support":n.showContenCol(["div_supportContentCol_main"])}},showContenCol:function(n){setTimeout(function(){try{$(window).scrollTop($("#"+n[0]).offset().top-200)}catch(t){$("html,body").animate({scrollTop:$("#"+n[0]).offset().top-200},100)}$("#div_block_main").height($(document).height());$("#div_block_main").css({display:""});$("#div_block_main").addClass("fadeIn animated infinite");$.each(n,function(n,t){$("#"+t).css({"z-index":"10026"})});setTimeout(function(){$("#div_block_main").css({display:"none"});$("#div_block_main").removeClass("fadeIn");$.each(n,function(n,t){$("#"+t).css({"z-index":"auto"})})},1e3)},200)}};return n}();