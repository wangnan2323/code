var _clientInf='{userid="",appcode="54",appname="",userip="",usermac="",username=""}',_blockMessage=null,_alertMessage=null,_resultMessage=null,_confirmMessage=null,tbl_ld_hsjlcardreport_list_Obj=function(){"use strict";var t=null,u="",i=null,r=null,f=function(t){try{n._pr_listtype=requestQuery("listtype");n._pr_appcode=requestQuery("appcode");n._pr_gridselectids=requestQuery("gridselectids");n._pr_gridpageindex=requestQuery("gridpageIndex");n._pr_searchcontent=requestQuery("searchcontent");_clientInf='{userid:"'+basePageObj._userInfoJson.sys_userid+'",appcode:"'+n._pr_appcode+'",appname:"",userip:"'+basePageObj._userInfoJson.ip+'",usermac:"'+basePageObj._userInfoJson.mac+'",username:"'+basePageObj._userInfoJson.sys_username+'"}';n._pr_gridpageindex=n._pr_gridpageindex==null||n._pr_gridpageindex==""||n._pr_gridpageindex=="null"?1:Number(n._pr_gridpageindex);n._pr_searchcontent=n._pr_searchcontent==null||n._pr_searchcontent==""||n._pr_searchcontent=="null"?{}:new Function("","return "+n._pr_searchcontent)();n._pr_listtype==null||n._pr_listtype==""||n._pr_listtype=="null"?_blockMessage.show("listtype参数接收失败...","fail"):t.success()}catch(i){_blockMessage.show("initParameter执行失败<br/>"+i.message,"fail")}},e=function(n){var i="";i=i.trimEnd("^");commonObj.getCodeServiceJson(i,{success:function(){try{t=new hashMap;commonObj.querySqls({tbl_ld_cben:"select sys_id as id,f_cbbh as text,f_cbymc,f_cbyid,f_cbzq,f_cbmc from tbl_ld_cben order by f_cbbh asc"},{success:function(i){t.put("codeservice_cben",i.tbl_ld_cben);n.success()},fail:function(){}})}catch(i){_blockMessage.show("initBaseCode执行失败。<br/>"+i.message,"fail")}}})},o=function(n){try{var i=t.get("codeservice_cben");controlObj.singledropdownlistinit("search_f_cben_tbl_ld_hsjlcardreport_list",i);n.success()}catch(r){_blockMessage.show("initSearchControl执行失败。<br/>"+r.message,"fail")}},s=function(t){try{var i={};i.f_cbbhid=controlObj.singledropdownlistid("search_f_cben_tbl_ld_hsjlcardreport_list");i.f_khbhfrom=controlObj.text("search_f_khbhfrom_tbl_ld_hsjlcardreport_list");i.f_khbhto=controlObj.text("search_f_khbhto_tbl_ld_hsjlcardreport_list");n._pr_searchcontent=i;t.success(n._pr_searchcontent)}catch(r){t.fail(r.message)}},h=function(t){var i="",r=n._pr_searchcontent;r.f_cbbhid.length>0&&(i+=" f_cbbhid = '"+r.f_cbbhid+"' and ");r.f_khbhfrom.length>0&&(i+=" f_khbh >= '"+r.f_khbhfrom+"' and ");r.f_khbhto.length>0&&(i+=" f_khbh <= '"+r.f_khbhto+"' and ");i.length>0&&(i=i.substr(0,i.length-4));u=i;t.success()},c=function(){},n={_pr_appcode:"",_pr_listtype:"",_pr_gridselectids:"",_pr_gridpageindex:1,_pr_searchcontent:null,init:function(){try{_alertMessage=new alertMessage;_resultMessage=new resultMessage;_confirmMessage=new confirmMessage;_blockMessage=new blockMessage;_blockMessage.show("程序加载中...","loading");basePageObj.initBasePage({success:function(){f({success:function(){e({success:function(){o({success:function(){i=Ladda.create("btn_preview_tbl_ld_hsjlcardreport_list");r=Ladda.create("btn_preview3_tbl_ld_hsjlcardreport_list");_blockMessage.hidden()}})}})}})},fail:function(n){_blockMessage.show(n,"fail")}})}catch(n){_blockMessage.show("程序初始化失败。<br/>"+n.message,"fail")}},btn_preview_onclick:function(t){var u,f,h;$("#div_print").html("");var c=controlObj.text("search_nd_tbl_ld_hsjlcardreport_list"),e=controlObj.singledropdownlistid("search_f_cben_tbl_ld_hsjlcardreport_list"),o=controlObj.text("search_khbhfrom_tbl_ld_hsjlcardreport_list"),s=controlObj.text("search_khbhto_tbl_ld_hsjlcardreport_list");e==""?_alertMessage.show("请选择抄本","fail"):(u=null,u=t==""?i:r,u.start(),f=" and 1=1",o!=""&&(f+=" and a.f_khbh>='"+o+"'"),s!=""&&(f+=" and a.f_khbh<='"+s+"'"),h={rows:"select b.f_mph as f_mph,a.f_khbh as f_khbh ,a.f_lxth as f_lxth,a.f_yhm as f_yhm,a.f_dz as f_dz,a.f_sbbh as f_sbbh,a.f_sbkj as f_sbkj,a.f_yslx as f_yslx,b.f_azrq as f_azrq ,nvl((SELECT F_BQZM FROM TBL_LD_KHB_TIME WHERE f_khbh = a.f_khbh and F_TIME = to_date('"+c+"-12-31', 'yyyy-mm-dd')  ),'0') as f_bqzm,a.f_yhfz as f_yhfz,(c.f_jtsj+c.f_pwf) as price from tbl_ld_khb a,tbl_ld_sbb b,tbl_ldbm_jtsj c where a.f_cbbhid='"+e+"' and a.f_sbbh=b.f_sbbh and a.f_yslxid=c.f_yslxid "+f+" order by f_cbxh asc",total:"select count(*) as count  from(select a.f_khbh as f_khbh ,a.f_lxth as f_lxth,a.f_yhm as f_yhm,a.f_dz as f_dz,a.f_sbbh as f_sbbh,a.f_sbkj as f_sbkj,a.f_yslx as f_yslx,b.f_azrq as f_azrq ,a.f_bqzm as f_bqzm,a.f_yhfz as f_yhfz,(c.f_jtsj+c.f_pwf) as price from tbl_ld_khb a,tbl_ld_sbb b,tbl_ldbm_jtsj c where a.f_cbbhid='"+e+"' and a.f_sbbh=b.f_sbbh and a.f_yslxid=c.f_yslxid "+f+")"},commonObj.querySqls(h,{success:function(i){var a=i.rows,f=parseInt(i.total[0].count),e,h,o;f>0&&(e=parseInt(f/3),h=parseInt(f%3),h>0&&(e=e+1));var r="";for(t==""||(e=parseInt(t)),o=0;o<e;o++){var s=o*3,c=s+1,l=s+2;r+='<DIV STYLE="page-break-before:always">';o==0?(r+='<table style="page-break-before:always;width:29.5cm;height:18.3cm;display:inline-block; margin:0; border-collapse:collapse;border-color:#000000" border="0" cellpadding="0" cellspacing="0" >',r+='<tr style="height:2.3cm;">'):(r+='<table style="page-break-before:always;width:29.5cm;height:18.8cm;display:inline-block; margin:0; border-collapse:collapse;border-color:#000000" border="0" cellpadding="0" cellspacing="0" >',r+='<tr style="height:2.8cm;">');r+='<td style="width:5.5cm">&nbsp;&nbsp;<\/td>';r+='<td style="width:22.5cm">';r+='<span style="font-size:19px;font-weight:bold;color:#000000;padding-left:17.5cm;" ><\/span><\/td>';r+='<td style="width:1.5cm"><\/td>';r+="<\/tr>";r+='<tr style="height:15cm;">';r+="<td>&nbsp;&nbsp;<\/td>";r+='<td style="vertical-align:text-top;">';r+='<table style="border-collapse:collapse;border-color:#000000" border="0" cellpadding="0" cellspacing="0">';r+="<tr>";r+='<td style="padding-left:0.1cm;padding-top:0px;vertical-align: text-top;">';r+=n.gethtml(i.rows[s]);r+="<\/td>";r+='<td style="padding-left:0.4cm;padding-top:0px;vertical-align: text-top;">';r+=c<f?n.gethtml(i.rows[c]):n.gethtml();r+="<\/td>";r+='<td style="padding-left:0.4cm;padding-top:0px;vertical-align: text-top;">';r+=l<f?n.gethtml(i.rows[l]):n.gethtml();r+="<\/td>";r+="<\/tr>";r+="<\/table>";r+="<\/td>";r+="<td><\/td>";r+="<\/tr>";r+='<tr style="height:1cm">';r+="<td>&nbsp;&nbsp;<\/td>";r+="<td>&nbsp;&nbsp;<\/td>";r+="<td>&nbsp;&nbsp;<\/td>";r+="<\/tr>";r+=" <\/table>";r+="<\/DIV>   "}$("#div_loading").css("display","none");$("#div_print").html(r);u.stop()},fail:function(){u.stop()}}))},btn_print:function(){$("#div_print").print({globalStyles:!1,mediaPrint:!1,iframe:!0,noPrintSelector:".avoid-this",prepend:"",append:""})},gethtml:function(n){var r=n,o="",s="",h="",c="",w="",l="",f="",a="",v="",y="",i="",p="",t,u,e;for(r==""||r==null||r==undefined||(o=r.f_khbh,s=r.f_lxth,h=r.f_yhm,c=r.f_dz,w=r.f_sbbh,l=r.f_sbkj,f=r.f_azrq.toDateTime().Format("yyyy-MM-dd"),a=r.f_yslx,v=r.price,y=r.f_bqzm,p=r.f_mph,i=","+r.f_yhfz+",",i=i.replaceAll(",龙达水务新立户表,",","),i=i.replaceAll(",龙达水务清户表,",","),i=i.replaceAll(",客服中心总表,",","),i=i.replaceAll(",客服中心大用户表,",","),i=i.replaceAll(",经营中心考核表,",","),i=i.replaceAll(",经营中心排子表,",","),i=i.replaceAll(",经营中心远传表,",","),i=i.replaceAll(",经营中心居民表,",","),i=i.trimEnd(","),i=i.trimStart(","),i=i.substr(0,10)),t="",t+='<table style="width:7.6cm;border-collapse:collapse;border-color:#000000" border="0" cellpadding="0" cellspacing="0">',t+="<tr>",t+="<td>",t+='<table style="border-collapse:collapse;border-color:#000000" border="0" cellpadding="0" cellspacing="0">',t+='<tr style="height:0.8cm;">',t+='<td style="width:1.3cm;text-align:center;font-size:12px;border-color:#000000;color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="width:2.6cm;text-align:center;font-size:12px;border-color:#000000">'+o+"<\/td>",t+='<td style="width:1.6cm;text-align:center;font-size:12px;border-color:#000000;color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="width:2.1cm;text-align:center;font-size:12px;border-color:#000000">'+s+"<\/td>",t+="<\/tr>",t+="<\/table>",t+="<\/td>",t+="<\/tr>",t+="<tr>",t+="<td>",t+='<table style="border-collapse:collapse;width:7.6cm;border-color:#000000" border="0" cellpadding="0" cellspacing="0">',t+='<tr style="height:0.8cm;">',t+='<td style="width:0.95cm;text-align:center;font-size:12px;border-color:#000000;color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="text-align:center;border-color:#000000;position:relative;">',t+='<span style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;font-size:12px;height:0.8cm;width:6.45cm;text-align: center;vertical-align: top;">'+h+"<\/span>",t+="<\/td>",t+="<\/tr>",t+='<tr style="height:1.4cm;">',t+='<td style="text-align:center;font-size:12px;width:0.95cm;border-color:#000000;color:#000000" rowspan="2">&nbsp;&nbsp;&nbsp;&nbsp;<\/td> ',t+='<td style="text-align:center;border-color:#000000;position:relative;">',t+='<span style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;font-size:12px;height:1.4cm;width:6.45cm;text-align: center;vertical-align: top;">'+c+"<\/span>",t+="<\/td>",t+=" <\/tr>",t+="<\/table>",t+="<\/td>",t+="<\/tr>",t+="<tr>",t+="<td>",t+='<table style="border-collapse:collapse;width:7.6cm;border-color:#000000" align="center" border="0" cellpadding="0" cellspacing="0">',t+='<tr style="height:0.8cm;">                                   ',t+='<td style="width:1.75cm;text-align:center;font-size:12px;border-color:#000000;color:#000000 ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="width:1.45cm; text-align:center;border-color:#000000;position:relative;">',t+='<span style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;font-size:12px;height:0.8cm;width:3cm;text-align: left;vertical-align: top;">'+i+"<\/span>",t+="<\/td>",t+='<td style="width:1.65cm; text-align:center;font-size:12px;border-color:#000000;color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="width:2.75cm; text-align:center;border-color:#000000;position:relative;">',t+='<span style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;font-size:12px;height:0.8cm;width:3cm;text-align: left;vertical-align: top;">'+p+"<\/span>",t+="<\/td>",t+="<\/tr>",t+='<tr style="height:0.8cm;">',t+='<td style="text-align:center;font-size:12px; border-color:#000000;color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="text-align:center;border-color:#000000;position:relative;">',t+='<span style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;font-size:12px;height:0.8cm;width:3cm;text-align: left;vertical-align: top;">'+l+"<\/span>",t+="<\/td>",t+='<td style="text-align:center;font-size:12px;border-color:#000000;color:#000000 ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',(f=="1900-01-01"||f=="1900/01/01")&&(f="&nbsp;&nbsp;&nbsp;&nbsp;"),t+='<td style="text-align:center;border-color:#000000;position:relative;">',t+='<span style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;font-size:12px;height:0.8cm;width:3cm;text-align: left;vertical-align: top;">'+f+"<\/span>",t+="<\/td>",t+="<\/tr>",t+='<tr style="height:0.72cm;">',t+='<td style="text-align:center;font-size:12px;border-color:#000000;color:#000000 ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <\/td>',t+='<td style="text-align:center;border-color:#000000;position:relative;">',t+='<span style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;font-size:12px;height:0.72cm;width:3cm;text-align: left;vertical-align: top;">'+a+"<\/span>",t+="<\/td>",t+='<td style="text-align:center;font-size:12px; border-color:#000000;color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="text-align:center;border-color:#000000;position:relative;">',t+='<span style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;font-size:12px;height:0.72cm;width:3cm;text-align: left;vertical-align: top;">'+v+"<\/span>",t+="<\/td>",t+="<\/tr>",t+="<\/table>",t+="<\/td>",t+="<\/tr>",t+="<tr>",t+="<td>",t+='<table style="border-collapse:collapse;width:7.6cm;border-color:#000000" align="center" border="0" cellpadding="0" cellspacing="0">',t+='<tr style="height:0.80cm;">                                   ',t+='<td style="width:0.6cm;text-align:center;font-size:12px;border-color:#000000;color:#000000 ">&nbsp;&nbsp;<\/td>',t+='<td style="width:0.65cm;text-align:center;font-size:12px;border-color:#000000;color:#000000 ">&nbsp;&nbsp;<\/td>',t+='<td style="width:1.7cm;text-align:center;font-size:12px;border-color:#000000;color:#000000 ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="width:1.15cm;text-align:center;font-size:12px;border-color:#000000;color:#000000 ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="width:1.65cm;text-align:center;font-size:12px; border-color:#000000;color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+='<td style="width:1.8cm;text-align:center;font-size:12px;border-color:#000000;color:#000000 ">&nbsp;&nbsp;&nbsp;&nbsp;<\/td>',t+="<\/tr>",t+='<tr style="height:0.80cm;text-align:center;font-size:12px;">',t+='<td style="border-color:#000000;color:#000000">&nbsp;&nbsp;<\/td>',t+='<td style="border-color:#000000;color:#000000"><\/td>',t+='<td style="border-color:#000000">'+y+"<\/td>",t+='<td style="border-color:#000000;color:#000000"><\/td>',t+='<td style="border-color:#000000;color:#000000"><\/td>',t+='<td style="border-color:#000000;color:#000000"><\/td>',t+="<\/tr>",u="",e=0;e<12;e++)u+='<tr style="height:0.80cm;text-align:center;font-size:12px;">',u+='<td style="border-color:#000000;color:#000000"><\/td>',u+='<td style="border-color:#000000;color:#000000"><\/td>',u+='<td style="border-color:#000000;color:#000000"><\/td>',u+='<td style="border-color:#000000;color:#000000"><\/td>',u+='<td style="border-color:#000000;color:#000000"><\/td>',u+='<td style="border-color:#000000;color:#000000"><\/td>',u+="<\/tr>";return t+=u,t+="<\/table>",t+="<\/td>",t+="<\/tr>",t+"<\/table>"},end:function(){}};return n}();$(document).ready(function(){tbl_ld_hsjlcardreport_list_Obj.init()});