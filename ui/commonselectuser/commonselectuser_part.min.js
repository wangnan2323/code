var commonselectuser_Obj=function(){var u="//127.0.0.1/sara.dd.ldsw/service/service_commonselectuser.asmx/",t=[],i=[],r=[],k="username",e=[],l=[],g=[],o=[],a=[],nt=[],s=[],v=[],tt=[],h=[],y=[],it=[],c=[],p=[],rt=[],b=function(){controlObj.text(n.selectUserIdsControlId,t.toString().replaceAll(",","^"));controlObj.text(n.selectUserNamesControlId,i.toString().replaceAll(",","^"));controlObj.text(n.selectUserPotourlsControlId,r.toString().replaceAll(",","^"));n.onChange!=null&&n.onChange()},w=function(){var r="";$.each(i,function(u){t[u]!=""&&(r+=n.controlType=="1"?' <span class="label label-warning hand"  id="span_selecteduser_'+t[u]+'_commonselectuser" onclick="commonselectuser_Obj.deleteUser(\''+t[u]+"');\">"+i[u]+"&times;<span><\/span><\/span>":' <span class="label label-warning hand" id="span_selecteduser_'+t[u]+'_commonselectuser">'+i[u]+"<span><\/span><\/span>")});$("#"+n.containerId+" #div_selecteduser_commonselectuser").html(r)},f=function(){var i;switch(k){case"role":i="";$.each(l,function(n){e[n]!=""&&(i+=t.indexOf(e[n])>-1?' <span class="label label-warning hand" >'+l[n]+"<span>√<\/span><\/span>":' <span class="label label-info hand" onclick="commonselectuser_Obj.addUser(\''+e[n]+"','"+l[n]+"','"+g[n]+"');\" >"+l[n]+"<span><\/span><\/span>")});$("#"+n.containerId+" #div_span_role_commonselectuser").html(i);break;case"position":i="";$.each(a,function(n){o[n]!=""&&(i+=t.indexOf(o[n])>-1?' <span class="label label-warning hand" >'+a[n]+"<span>√<\/span><\/span>":' <span class="label label-info hand" onclick="commonselectuser_Obj.addUser(\''+o[n]+"','"+a[n]+"','"+nt[n]+"');\" >"+a[n]+"<span><\/span><\/span>")});$("#"+n.containerId+" #div_span_position_commonselectuser").html(i);break;case"usergroup":i="";$.each(v,function(n){s[n]!=""&&(i+=t.indexOf(s[n])>-1?' <span class="label label-warning hand" >'+v[n]+"<span>√<\/span><\/span>":' <span class="label label-info hand" onclick="commonselectuser_Obj.addUser(\''+s[n]+"','"+v[n]+"','"+tt[n]+"');\" >"+v[n]+"<span><\/span><\/span>")});$("#"+n.containerId+" #div_span_usergroup_commonselectuser").html(i);break;case"username":i="";$.each(p,function(n){c[n]!=""&&(i+=t.indexOf(c[n])>-1?' <span class="label label-warning hand" >'+p[n]+"<span>√<\/span><\/span>":' <span class="label label-info hand" onclick="commonselectuser_Obj.addUser(\''+c[n]+"','"+p[n]+"','"+rt[n]+"');\" >"+p[n]+"<span><\/span><\/span>")});$("#"+n.containerId+" #div_span_username_commonselectuser").html(i);break;case"organ":i="";$.each(y,function(n){h[n]!=""&&(i+=t.indexOf(h[n])>-1?' <span class="label label-warning hand" >'+y[n]+"<span>√<\/span><\/span>":' <span class="label label-info hand" onclick="commonselectuser_Obj.addUser(\''+h[n]+"','"+y[n]+"','"+it[n]+"');\" >"+y[n]+"<span><\/span><\/span>")});$("#"+n.containerId+" #div_span_organ_commonselectuser").html(i)}},d=function(n){return n.removed==undefined||n.added==undefined?!0:n.added.id!=n.removed.id?!0:!1},et=function(t){if(d(t)){var i={queryParameter:t.val.toString().replaceAll(",","^"),whereClause:n.whereClause,queryType:"role",clientInf:_clientInf};doAjaxFunction(u,"GetUserNames",i,{success:function(n){var t=new Function("","return "+n)();e=t.userids.split("^");l=t.usernames.split("^");g=t.phototurls.split("^");f()},fail:function(n){_blockMessage.show(u+"GetUserNames<br/>"+n,"fail")}})}},ot=function(t){if(d(t)){var i={queryParameter:t.val.toString().replaceAll(",","^"),whereClause:n.whereClause,queryType:"position",clientInf:_clientInf};doAjaxFunction(u,"GetUserNames",i,{success:function(n){var t=new Function("","return "+n)();o=t.userids.split("^");a=t.usernames.split("^");nt=t.phototurls.split("^");f()},fail:function(n){_blockMessage.show(u+"GetUserNames<br/>"+n,"fail")}})}},st=function(t){if(d(t)){var i={queryParameter:t.val.toString().replaceAll(",","^"),whereClause:n.whereClause,queryType:"usergroup",clientInf:_clientInf};doAjaxFunction(u,"GetUserNames",i,{success:function(n){var t=new Function("","return "+n)();s=t.userids.split("^");v=t.usernames.split("^");tt=t.phototurls.split("^");f()},fail:function(n){_blockMessage.show(u+"GetUserNames<br/>"+n,"fail")}})}},ht=function(t){if(d(t)){var i={queryParameter:t.val.toString().replaceAll(",","^"),whereClause:n.whereClause,queryType:"organ",clientInf:_clientInf};doAjaxFunction(u,"GetUserNames",i,{success:function(n){var t=new Function("","return "+n)();h=t.userids.split("^");y=t.usernames.split("^");it=t.phototurls.split("^");f()},fail:function(n){_blockMessage.show(u+"GetUserNames<br/>"+n,"fail")}})}},ut=function(){$("#"+n.containerId+" #label_selecteduser_commonselectuser .icon-exclamation-sign").hasClass("hidden")&&($("#"+n.containerId+" #label_selecteduser_commonselectuser").popover({animation:!0,content:'最多选择<a style="color:red" >'+n.maxSelectedUser+"<\/a>个用户",html:!0,placement:"top",trigger:"click"}),$("#"+n.containerId+"").addClass("has-error"),$("#"+n.containerId+" #label_selecteduser_commonselectuser .icon-exclamation-sign").removeClass("hidden"),$("#"+n.containerId+" #label_selecteduser_commonselectuser").popover("show"))},ft=function(){$("#"+n.containerId+" #label_selecteduser_commonselectuser .icon-exclamation-sign").hasClass("hidden")||($("#"+n.containerId+"").removeClass("has-error"),$("#"+n.containerId+" #label_selecteduser_commonselectuser .icon-exclamation-sign").addClass("hidden"),$("#"+n.containerId+" #label_selecteduser_commonselectuser").popover("destroy"))},n={controlType:"1",searchTabArray:["username","role","position","usergroup","organ"],maxSelectedUser:"0",containerId:"",selectUserIdsControlId:"",selectUserNamesControlId:"",selectUserPotourlsControlId:"",showText:"",whereClause:"",onChange:null,init:function(f){if($("#"+n.containerId+" #a_selecteduser_commonselectuser").html(n.showText),controlObj.text(n.selectUserIdsControlId)!=""&&(t=controlObj.text(n.selectUserIdsControlId).split("^")),controlObj.text(n.selectUserNamesControlId)!=""&&(i=controlObj.text(n.selectUserNamesControlId).split("^")),controlObj.text(n.selectUserPotourlsControlId)!=""&&(r=controlObj.text(n.selectUserPotourlsControlId).split("^")),w(),n.controlType=="1"){$("#"+n.containerId+" #ul_tab_commonselectuser").removeClass("hidden");$("#"+n.containerId+" #div_content_commonselectuser").removeClass("hidden");$("#"+n.containerId+" #div_selecteduser_allcontrol").removeClass("hidden");$.each(n.searchTabArray,function(t){t==0&&($("#"+n.containerId+" #li_"+n.searchTabArray[t]+"_commonselectuser").addClass("active"),$("#"+n.containerId+" #div_"+n.searchTabArray[t]+"_commonselectuser").removeClass("hidden"));$("#"+n.containerId+" #li_"+n.searchTabArray[t]+"_commonselectuser").removeClass("hidden")});var e={clientInf:_clientInf};doAjaxFunction(u,"GetBaseCode",e,{success:function(t){var i=new Function("","return "+t)(),r=new Function("","return "+i.role)(),u=new Function("","return "+i.position)(),e=new Function("","return "+i.usergroup)(),o=new Function("","return "+i.organ)();controlObj.multidropdownlistinit(n.containerId+" #dropdown_role_commonselectuser",r,et);controlObj.multidropdownlistinit(n.containerId+" #dropdown_position_commonselectuser",u,ot);controlObj.multidropdownlistinit(n.containerId+" #dropdown_usergroup_commonselectuser",e,st);controlObj.multidropdownlistinit(n.containerId+" #dropdown_organ_commonselectuser",o,ht);f.success()},fail:function(n){_blockMessage.show(u+"GetBaseCode<br/>"+n,"fail")}})}else $("#"+n.containerId+" #div_selecteduser_allcontrol").addClass("hidden"),$("#"+n.containerId+" #ul_tab_commonselectuser").addClass("hidden"),$("#"+n.containerId+" #div_content_commonselectuser").addClass("hidden"),f.success()},li_onclick:function(t){var i,r,u,e;k=t;i=$("#"+n.containerId+" #li_"+t+"_commonselectuser");i.hasClass("active")||(r=i.parent().children(),$.each(r,function(n){$(r[n]).removeClass("active")}),i.addClass("active"),u=$("#"+n.containerId+" #div_"+t+"_commonselectuser"),e=u.parent().children(),$.each(e,function(n){$(e[n]).addClass("hidden")}),u.removeClass("hidden"),f())},deleteUser:function(n){var u=t.indexOf(n);t=t.remove(u);i.length!=0&&(i=i.remove(u));r.length!=0&&(r=r.remove(u));w();b();f()},deleteAllUser:function(){i=[];t=[];r=[];w();b();f()},addUser:function(u,e,o){n.maxSelectedUser=="0"?(t.push(u),i.push(e),r.push(o),w(),b(),f()):t.length>=n.maxSelectedUser?ut():(ft(),t.push(u),i.push(e),r.push(o),w(),b(),f())},addAllUser:function(){var u=!1;if(n.maxSelectedUser=="0")u=!0;else if(t.length>n.maxSelectedUser)u=!1;else switch(k){case"role":u=t.length+e.length>n.maxSelectedUser?!1:!0;break;case"position":u=t.length+o.length>n.maxSelectedUser?!1:!0;break;case"usergroup":u=t.length+s.length>n.maxSelectedUser?!1:!0;break;case"username":u=t.length+c.length>n.maxSelectedUser?!1:!0;break;case"organ":u=t.length+h.length>n.maxSelectedUser?!1:!0}if(u){switch(k){case"role":$.each(e,function(n){t.push(e[n]);i.push(l[n]);r.push(g[n])});break;case"position":$.each(o,function(n){t.push(o[n]);i.push(a[n]);r.push(nt[n])});break;case"usergroup":$.each(s,function(n){t.push(s[n]);i.push(v[n]);r.push(tt[n])});break;case"username":$.each(c,function(n){t.push(c[n]);i.push(p[n]);r.push(rt[n])});break;case"organ":$.each(h,function(n){t.push(h[n]);i.push(y[n]);r.push(it[n])})}w();b();f();ft()}else ut()},btn_txt_username_onclick:function(){var t={queryParameter:controlObj.text(n.containerId+" #txt_username_commonselectuser"),whereClause:n.whereClause,queryType:"username",clientInf:_clientInf};doAjaxFunction(u,"GetUserNames",t,{success:function(n){var t=new Function("","return "+n)();c=t.userids.split("^");p=t.usernames.split("^");rt=t.phototurls.split("^");f()},fail:function(n){_blockMessage.show(u+"GetUserNames<br/>"+n,"fail")}})}};return n}();